/*! HSO D365 CLI 7.0.9 | (c) HSO Innovation */!function(){"use strict";var e={9051:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Create=void 0;var u=s(n(3672)),l=i(n(8489)),f=s(n(9937)),d=i(n(9896)),p=function(){function e(){}return e.createProject=function(t,n){if(!l.test("-e","".concat(t,"/Webresources")))return e.create(t,n);console.log(u.default.red("Project ".concat(t,"/Webresources already exist!")))},e.showCreateHelp=function(){console.log("Arguments:"),console.log("   "+u.default.blue("project")),console.log("     The project name of the new workspace and initial Webresource setup.")},e.create=function(t,n){return a(this,void 0,void 0,(function(){var r;return c(this,(function(o){switch(o.label){case 0:return r=n,n.environment&&n.solution_deploy&&n.publisher_name&&n.publisher_prefix&&n.namespace?[3,2]:(console.log(u.default.red("Missing some required options (environment, solution_deploy, publisher_name, \n            publisher_prefix, namespace. Command line will request them now.")),[4,e.inquirer()]);case 1:r=o.sent(),o.label=2;case 2:return console.log("Initializing D365 Project ".concat(t,"...")),l.test("-e","".concat(t))||l.mkdir(t),l.cd(t),l.cp("-R","".concat(__dirname,"/root/crm.json"),"."),e.setupWebresources(t,r),[2]}}))}))},e.setupWebresources=function(t,n){l.mkdir("Webresources"),l.cp("-R","".concat(__dirname,"/root/Webresources/*"),"Webresources"),l.cp("-R","".concat(__dirname,"/root/Webresources/.*"),"Webresources"),d.renameSync("./Webresources/gitignore","./Webresources/.gitignore"),e.initCrmJson(n),e.initWebresourcesCrmJson(n),e.initWebresourcesPackageJson(t,n),e.initWebresourcesWebpackConfig(n),l.cd("Webresources"),console.log("Installing npm packages. This may take a while..."),l.exec("npm install"),console.log("Initializing D365 Project done"),console.log("".concat(u.default.blue("hso-d365 generate Entity x")," in Webresources folder generates Entity x files and settings.")),console.log("".concat(u.default.blue("npm run build:prod")," in Webresources folder creates the deployment package.")),console.log("See package.json#scripts for all options."),l.cd("..")},e.initCrmJson=function(e){var t=l.ls("./crm.json")[0];l.sed("-i",new RegExp("<%= publisher_prefix %>","ig"),e.publisher_prefix,t),l.sed("-i",new RegExp("<%= environment %>","ig"),e.environment,t),l.sed("-i",new RegExp("<%= namespace %>","ig"),e.namespace,t);var n=l.exec("hso-d365 --version").stdout.replace(/\n/gi,"");l.sed("-i",new RegExp("<%= version %>","ig"),n,t)},e.initWebresourcesCrmJson=function(e){var t=l.ls("Webresources/crm.json")[0];l.sed("-i",new RegExp("<%= solution_name_deploy %>","ig"),e.solution_deploy,t),l.sed("-i",new RegExp("<%= solution_name_generate %>","ig"),e.solution_generate||e.solution_deploy,t)},e.initWebresourcesPackageJson=function(e,t){var n=l.ls("Webresources/package.json")[0];l.sed("-i","<%= projectname %>",e.toLowerCase(),n),l.sed("-i",new RegExp("<%= description %>","ig"),t.solution_deploy,n)},e.initWebresourcesWebpackConfig=function(e){var t=l.ls("Webresources/webpack.config.ts")[0];l.sed("-i",new RegExp("<%= publisher_prefix %>","ig"),e.publisher_prefix,t),l.sed("-i",new RegExp("<%= namespace %>","ig"),e.namespace,t),l.sed("-i",new RegExp("<%= description %>","ig"),e.namespace,t)},e.inquirer=function(){var e=this;return f.default.prompt([{type:"input",name:"environment",message:"D365 environment url (eg. https://yourproject.crm4.dynamics.com):",validate:function(t){return a(e,void 0,void 0,(function(){return c(this,(function(e){if(!t)throw new Error("You need to provide an environment");if(!new RegExp("https://(www\\.)?[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}").test(t))throw new Error("You need to provide a valid url");return[2,!0]}))}))}},{type:"input",name:"solution_deploy",message:"D365 deployment Solution ('Name' column):",validate:function(t){return a(e,void 0,void 0,(function(){return c(this,(function(e){if(!t)throw new Error("You need to provide a solution");if(!new RegExp("[a-zA-Z_\\d]*").test(t))throw new Error("You need to provide a valid solution name");return[2,!0]}))}))}},{type:"input",name:"solution_generate",message:"D365 generate Solution ('Name' column)\nIf equal to deployment Solution keep blank:",validate:function(t){return a(e,void 0,void 0,(function(){return c(this,(function(e){if(t&&!new RegExp("[a-zA-Z_\\d]*").test(t))throw new Error("You need to provide a valid solution name");return[2,!0]}))}))}},{type:"input",name:"publisher_name",message:"D365 Publisher Name (not Display Name):",validate:function(t){return a(e,void 0,void 0,(function(){return c(this,(function(e){if(!t)throw new Error("You need to provide a publisher name");if(!new RegExp("[a-zA-Z_0-9]*").test(t))throw new Error("You need to provide a valid publisher");return[2,!0]}))}))}},{type:"input",name:"publisher_prefix",message:"D365 Publisher Prefix (3 chars a-z):",validate:function(t){return a(e,void 0,void 0,(function(){return c(this,(function(e){if(!t)throw new Error("You need to provide a publisher");if(!new RegExp("[a-zA-Z_\\d]*").test(t))throw new Error("You need to provide a valid publisher");return[2,!0]}))}))}},{type:"input",name:"namespace",message:"Customer or Product name:",validate:function(t){return a(e,void 0,void 0,(function(){return c(this,(function(e){if(!t)throw new Error("You need to provide a customer or product name");if(!new RegExp("[a-zA-Z_\\d]*").test(t))throw new Error("You need to provide a valid namespace");return[2,!0]}))}))}}])},e}();t.Create=p},9836:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Deploy=void 0;var f=c(n(9896)),d=n(5127),p=n(7301),h=c(n(6982)),b=c(n(6566)),y=c(n(8489)),m=l(n(3672)),g=n(4789),v=function(e){function t(t){var n=e.call(this)||this;return n.webresourceSettings=JSON.parse(f.readFileSync("./crm.json","utf8")),n.md5=function(e){return h.createHash("md5").update(e).digest("hex")},n.force=t,n}return o(t,e),t.deployProject=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(n){return process.argv[4]?console.log(m.default.red("No spaces allowed after update command!")):f.existsSync("./dist")?new t(e):console.log(m.default.red("No dist folder found. Please run 'npm run build:prod' or 'hso-d365 build' first")),[2]}))}))},t.prototype.onAuthenticated=function(){return this.deploy()},t.prototype.deploy=function(){return s(this,void 0,void 0,(function(){var e,t,n;return u(this,(function(r){switch(r.label){case 0:return e=this.settings.crm,t=e.publisher_prefix,n=e.url,console.log("Deploying to ".concat(n,"...")),[4,this.deployDirectory("dist/".concat(t,"_"))];case 1:return r.sent(),[4,g.SetOnloads.setOnLoads(this.bearer)];case 2:return r.sent(),console.log("Deploy finished"),[2]}}))}))},t.prototype.deployDirectory=function(e){return s(this,void 0,void 0,(function(){var t=this;return u(this,(function(n){return[2,new Promise((function(n){f.readdir(e,(function(r,o){return s(t,void 0,void 0,(function(){var t,r,i,a,c,s,l,d,p;return u(this,(function(u){switch(u.label){case 0:t=[],r=0,i=o,u.label=1;case 1:return r<i.length?(a=i[r],c="".concat(e,"/").concat(a),f.lstatSync(c).isDirectory()?(l=(s=t).push,[4,this.deployDirectory(c)]):[3,3]):[3,6];case 2:return l.apply(s,[u.sent()]),[3,5];case 3:return p=(d=t).push,[4,this.deployFile(c)];case 4:p.apply(d,[u.sent()]),u.label=5;case 5:return r++,[3,1];case 6:return Promise.all(t).then((function(){n()})),[2]}}))}))}))}))]}))}))},t.prototype.deployFile=function(e){return s(this,void 0,void 0,(function(){var t,n;return u(this,(function(r){switch(r.label){case 0:return t=e.substr(5),[4,this.getWebresource(t)];case 1:return n=r.sent(),console.log("".concat(t)),n?[4,this.updateWebresource(n,e)]:[3,3];case 2:return r.sent(),[3,5];case 3:return[4,this.insertWebresource(e,t)];case 4:r.sent(),r.label=5;case 5:return[2]}}))}))},t.prototype.updateWebresource=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o,i,a,c;return u(this,(function(s){switch(s.label){case 0:return n=this.md5(e.content),r=f.readFileSync(t),o=r.toString("base64"),[4,this.generateDependencyXML(t,e,r)];case 1:if(i=s.sent(),a=this.md5(o),!(this.force||n!==a||i&&i!==(null==e?void 0:e.dependencyxml)))return[3,7];e.content=o,e.dependencyxml=i,s.label=2;case 2:return s.trys.push([2,5,,6]),[4,d.WebresourceService.upsert(e,this.bearer)];case 3:return s.sent(),console.log("updated..."),[4,d.WebresourceService.publish(e,this.bearer)];case 4:return s.sent(),console.log("and published"),[3,6];case 5:return c=s.sent(),console.log("failed ".concat(c.message)),[3,6];case 6:return[3,8];case 7:console.log("unmodified"),s.label=8;case 8:return[2]}}))}))},t.prototype.insertWebresource=function(e,t){return s(this,void 0,void 0,(function(){var n,r,o,i,a,c,s;return u(this,(function(u){switch(u.label){case 0:n=f.readFileSync(e),r=n.toString("base64"),u.label=1;case 1:return u.trys.push([1,5,,6]),o=this.webresourceSettings.crm.solution_name_deploy,i={content:r,name:t,displayname:t},[4,this.generateDependencyXML(e,i,n)];case 2:return(a=u.sent())&&(i.dependencyxml=a),[4,d.WebresourceService.upsert(i,this.bearer)];case 3:return c=u.sent(),console.log(" inserted..."),[4,d.WebresourceService.addToSolution(c,o,this.bearer)];case 4:return u.sent(),console.log(" and added to solution ".concat(o)),[2,c];case 5:return s=u.sent(),console.log(" failed ".concat(s.message)),[3,6];case 6:return[2]}}))}))},t.prototype.getWebresource=function(e){return s(this,void 0,void 0,(function(){return u(this,(function(t){switch(t.label){case 0:return[4,d.WebresourceService.retrieveMultipleRecords({select:["name","webresourcetype","content","displayname","solutionid","dependencyxml"],filters:[{conditions:[{attribute:"name",value:e}]}],top:1},this.bearer)];case 1:return[2,t.sent()[0]]}}))}))},t.prototype.generateDependencyXML=function(e,t,n){return s(this,void 0,void 0,(function(){var r,o;return u(this,(function(i){switch(i.label){case 0:return t.name.endsWith(".js")?[4,this.getDependencyXML(t,n)]:[3,2];case 1:return[2,i.sent()];case 2:return t.name.endsWith(".html")?(r=e.replace(/.html/g,".js"),f.existsSync(r)?(o=f.readFileSync(r),[4,this.getDependencyXML(t,o)]):[3,4]):[3,5];case 3:return[2,i.sent()];case 4:console.log("script file: ".concat(r," does not exist")),i.label=5;case 5:return[2]}}))}))},Object.defineProperty(t,"xmlRegex",{get:function(){return/(\s?\n+\s+|\n)/g},enumerable:!1,configurable:!0}),t.prototype.getDependencyXML=function(e,n){return s(this,void 0,void 0,(function(){var r,o,i,a;return u(this,(function(c){switch(c.label){case 0:return[4,this.generateWebresourceXmlDoc(e,n)];case 1:return(r=c.sent())?(o=t.xmlBuilder.buildObject(r),i=o.replace(t.xmlRegex,""),a=i.indexOf("?>"),[2,i=i.substr(a+2)]):[2]}}))}))},Object.defineProperty(t,"defaultDependencyxml",{get:function(){return'<Dependencies><Dependency componentType="WebResource"></Dependency></Dependencies>'},enumerable:!1,configurable:!0}),Object.defineProperty(t,"translationRegex",{get:function(){return/\.translate\(["'](.*)["']\)/gm},enumerable:!1,configurable:!0}),t.prototype.generateWebresourceXmlDoc=function(e,n){return s(this,void 0,void 0,(function(){var r,o,i;return u(this,(function(a){switch(a.label){case 0:return r=y.ls("dist/**/locales/*.resx"),0===(o=r.map((function(e){return e.substr(5)}))).length&&null===e.dependencyxml?[2,null]:[4,b.parseStringPromise(e.dependencyxml||t.defaultDependencyxml)];case 1:return i=a.sent(),t.translationRegex.test(String(n))?(this.addLibraries(i,o),this.cleanLibraries(i,o)):this.cleanLibraries(i),[2,i]}}))}))},t.prototype.addLibraries=function(e,n){var r=e.Dependencies.Dependency[0];r.Library||(r.Library=[]);for(var o=function(e){r.Library.find((function(t){return t.$.name===e}))||(console.log("Adding dependency: ".concat(e)),r.Library.push({$:t.createLibraryItem(e)}))},i=0,a=n;i<a.length;i++){o(a[i])}},Object.defineProperty(t,"localesResxRegex",{get:function(){return/locales\/locales[.]?(\d{4})?.resx/gm},enumerable:!1,configurable:!0}),t.prototype.cleanLibraries=function(e,n){void 0===n&&(n=[]);var r=e.Dependencies.Dependency[0];if(r.Library)for(var o=r.Library.length-1;o>=0;o-=1){var i=r.Library[o].$.name;t.localesResxRegex.test(i)&&(n.includes(i)||(console.log("Removing dependency: ".concat(i)),r.Library.splice(o,1)))}},t.createLibraryItem=function(e){return{name:e,displayName:e,languagecode:t.getLanguageCode(e),description:"",libraryUniqueId:t.guid()}},t.getLanguageCode=function(e){var n;return e.endsWith(".resx")&&(n=t.localesResxRegex.exec(e)),n&&n[1]||""},t.guid=function(){return"{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.xmlBuilder=new b.Builder,t}(p.MsalRouter);t.Deploy=v},2017:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.Resx=void 0;var s=i(n(8489)),u=i(n(9896)),l=i(n(6566)),f=function(){function e(){}return e.extract=function(){return a(this,void 0,void 0,(function(){var t;return c(this,(function(n){switch(n.label){case 0:return(t=e.getCodeKeys()).length>0&&e.addLocalesFile(),[4,e.processCodeKeys(t)];case 1:return n.sent(),[2,null]}}))}))},e.getCodeKeys=function(){for(var t=new Set,n=0,r=s.ls("src/**/*.ts*");n<r.length;n++)for(var o=r[n],i=String(u.readFileSync(o)),a=null;null!==(a=e.regex.exec(i));)a.index===e.regex.lastIndex&&(e.regex.lastIndex+=1),t.add(a[2]||a[3]||a[4]);return Array.from(t.values())},e.addLocalesFile=function(){s.test("-d","src/translation/locales")||s.mkdir("src/translation/locales"),s.test("-f","src/translation/locales/locales.resx")||(s.cp("-R","".concat(__dirname,"/Translation/locales.resx"),"./src/translation/locales"),s.exec("git add src/translation/locales/locales.resx")),s.test("-f","src/translation/locales/locales.1033.resx")||(s.cp("-r","".concat(__dirname,"/Translation/locales.resx"),"./src/translation/locales/locales.1033.resx"),s.exec("git add src/translation/locales/locales.1033.resx"))},e.processCodeKeys=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:n=s.ls("src/translation/locales/*.resx"),r=0,o=n,c.label=1;case 1:return r<o.length?(i=o[r],[4,e.getResxDocument(i)]):[3,4];case 2:a=c.sent(),e.processXmlDoc(a,t),e.writeXmlDoc(a,i),c.label=3;case 3:return r++,[3,1];case 4:return[2]}}))}))},e.getResxDocument=function(e){var t=String(u.readFileSync(e));return l.parseStringPromise(t)},e.processXmlDoc=function(e,t){for(var n=e.root.data.map((function(e){return e.$.name})),r=function(n){if(!t.includes(n)){var r=e.root.data.find((function(e){return e.$.name===n})),o=e.root.data.indexOf(r);e.root.data.splice(o,1),console.log("remove ".concat(n))}},o=0,i=n;o<i.length;o++){r(i[o])}for(var a=0,c=t;a<c.length;a++){var s=c[a];n.includes(s)||(e.root.data.push({$:{name:s,"xml:space":"preserve"},value:[s]}),console.log("add ".concat(s)))}},e.writeXmlDoc=function(e,t){var n=(new l.Builder).buildObject(e);s.ShellString(n).to(t)},e.regex=/Translation\.translate\([\s]*([']([^']*)[']|[`]([^`]*)[`]|["]([^"]*)["])[\s]*\)/gm,e}();t.Resx=f},5141:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SetFormCustomizable=void 0;var c=n(7301),s=n(4935),u=n(4409),l=function(e){function t(t){var n=e.call(this)||this;return n.customizable=t,n}return o(t,e),t.prototype.onAuthenticated=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){return console.log("Customizable: ".concat(this.customizable)),[2,this.setFormCustomizable()]}))}))},t.prototype.setFormCustomizable=function(){return i(this,void 0,void 0,(function(){var e,t,n,r,o;return a(this,(function(i){switch(i.label){case 0:return[4,u.SolutionComponentSummaryService.retrieveFormSolutionComponentSummaries(this.bearer)];case 1:e=i.sent(),t=0,n=e,i.label=2;case 2:return t<n.length?(r=n[t],console.log("SolutionComponent: ".concat(r.msdyn_objectid)),[4,this.getSystemForm(r)]):[3,6];case 3:return o=i.sent(),[4,this.setForm(o,this.customizable)];case 4:i.sent(),i.label=5;case 5:return t++,[3,2];case 6:return[2]}}))}))},t.prototype.setForm=function(e,t){return i(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:if(console.log("Form name: ".concat(e.name)),e.iscustomizable.Value===t&&e.canbedeleted.Value===t)return[3,5];e.iscustomizable.CanBeChanged&&(e.iscustomizable.Value=t),e.canbedeleted.CanBeChanged&&(e.canbedeleted.Value=t),r.label=1;case 1:return r.trys.push([1,3,,4]),[4,s.SystemFormService.updateRecord(e.formid,e,this.bearer)];case 2:return r.sent(),console.log("Updated"),[3,4];case 3:return n=r.sent(),console.log(n.message),[3,4];case 4:return[3,6];case 5:console.log("Unmodified"),r.label=6;case 6:return console.log("---------------------------"),[2]}}))}))},t.prototype.getSystemForm=function(e){return s.SystemFormService.getSystemForm(e.msdyn_objectid,["name","objecttypecode","iscustomizable","canbedeleted"],this.bearer)},t}(c.MsalRouter);t.SetFormCustomizable=l},4789:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SetOnloads=void 0;var s=n(7301),u=n(4409),l=n(4935),f=c(n(9896)),d=n(511),p=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.prototype.onAuthenticated=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){return console.log("Onloads"),[2,t.setOnLoads(this.bearer)]}))}))},t.setOnLoads=function(e){return i(this,void 0,void 0,(function(){var t,n,r,o,i,c,s,l,p,h,b,y,m,g,v,w,_;return a(this,(function(a){switch(a.label){case 0:return[4,u.SolutionComponentSummaryService.retrieveFormSolutionComponentSummaries(e)];case 1:t=a.sent(),n=0,r=t,a.label=2;case 2:return n<r.length?(o=r[n],[4,this.getSystemForm(o,e)]):[3,6];case 3:return i=a.sent(),c=JSON.parse(f.default.readFileSync("../crm.json","utf8")),s=c.crm,l=s.publisher_prefix,p=s.namespace,h=o.msdyn_displayname.replace(/\W/g,""),b=i.name.replace(/\W/g,""),y="".concat(l,".").concat(p,".").concat(h,".").concat(b,".Form.onLoad"),m="".concat(l,"_/").concat(p,"/").concat(h,"/").concat(b,".js"),g="dist/".concat(m),f.default.existsSync(g)?(v=(new d.DOMParser).parseFromString(i.formxml,"text/xml"),w=this.addOnloadHandler(v,m,y),_=this.addFormLibrary(v,m),w||_?(i.formxml=(new d.XMLSerializer).serializeToString(v),[4,this.setForm(i,e)]):[3,5]):[3,5];case 4:a.sent(),a.label=5;case 5:return n++,[3,2];case 6:return[2]}}))}))},t.addOnloadHandler=function(e,n,r){var o=e.documentElement,i=!1,a=o.getElementsByTagName("events")[0];a||(console.log("Creating events element"),a=e.createElement("events"),o.appendChild(a),i=!0);for(var c,s=a.getElementsByTagName("event"),u=0;u<s.length;u+=1){if("onload"===(p=s[u]).getAttribute("name")){c=p;break}}c||(console.log("Creating onload event element"),(c=e.createElement("event")).setAttribute("name","onload"),c.setAttribute("application","false"),c.setAttribute("active","false"),a.appendChild(c),i=!0);var l=c.getElementsByTagName("Handlers")[0];l||(console.log("Creating handlers element"),l=e.createElement("Handlers"),c.appendChild(l),i=!0);var f,d=l.getElementsByTagName("Handler");for(u=0;u<d.length;u+=1){var p;if((p=d[u]).getAttribute("functionName")===r){f=p;break}}return f?console.log("Handler already exists: ".concat(r)):(console.log("Creating handler: ".concat(r)),(f=e.createElement("Handler")).setAttribute("functionName",r),f.setAttribute("libraryName",n),f.setAttribute("enabled","true"),f.setAttribute("passExecutionContext","true"),f.setAttribute("handlerUniqueId",t.guid()),l.appendChild(f),i=!0),i},t.addFormLibrary=function(e,n){var r=e.documentElement,o=!1,i=r.getElementsByTagName("formLibraries")[0];i||(console.log("Creating formLibraries element"),i=e.createElement("formLibraries"),r.appendChild(i),o=!0);for(var a,c=i.getElementsByTagName("Library"),s=0;s<c.length;s+=1){var u=c[s];if(u.getAttribute("name")===n){a=u;break}}return a?console.log("Library already exists: ".concat(n)):(console.log("Creating formLibrary element"),(a=e.createElement("Library")).setAttribute("name",n),a.setAttribute("libraryUniqueId",t.guid()),i.appendChild(a),o=!0),o},t.getSystemForm=function(e,t){return l.SystemFormService.getSystemForm(e.msdyn_objectid,["name","formxml"],t)},t.setForm=function(e,t){return i(this,void 0,void 0,(function(){var n;return a(this,(function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,l.SystemFormService.updateRecord(e.formid,e,t)];case 1:return r.sent(),console.log("Updated ".concat(e.name)),[3,3];case 2:return n=r.sent(),console.log(n.message),[3,3];case 3:return[2]}}))}))},t.guid=function(){return"{xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx}".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t}(s.MsalRouter);t.SetOnloads=p},8070:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Update=void 0;var u=i(n(3672)),l=s(n(8489)),f=s(n(9896)),d=s(n(5317)),p=function(){function e(){}return e.updateProject=function(){if(process.argv[3])console.log(u.red("No spaces allowed after update command!"));else{if(l.default.test("-e","src"))return e.update();console.log(u.red("You are not inside the project Webresources folder!"))}},e.showUpdateHelp=function(){console.log("Arguments:")},e.update=function(){return a(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return console.log("Updating D365 Project..."),e.updateSrcFolder(),e.updateCrmJson(),e.updateProjectRootFolder(),e.updateEntityFiles(),e.updateFormFiles(),e.updatePackageJson(),[4,e.updateWebpackConfig()];case 1:return t.sent(),console.log("Updating D365 Project done"),[2]}}))}))},e.updateProjectRootFolder=function(){console.log("Updating .eslintignore..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/.eslintignore"),"."),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add",".eslintignore"]),console.log("Updating .gitignore..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/gitignore"),"."),f.default.renameSync("./gitignore","./.gitignore"),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add",".gitignore"]),console.log("Updating .eslintrc.json..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/.eslintrc.json"),"."),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add",".eslintrc.json"]),console.log("Updating postcss.config.js"),l.default.cp("-R","".concat(__dirname,"/root/Webresources/postcss.config.js"),"."),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","postcss.config.js"]),console.log("Remove karma.conf.js"),l.default.test("-e","../.git")?d.default.execFileSync("git",["rm","karma.conf.js"]):l.default.rm("karma.conf.js"),console.log("Updating tsconfig.json"),l.default.cp("-R","".concat(__dirname,"/root/Webresources/tsconfig.json"),"."),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","tsconfig.json"])},e.updateEntityFiles=function(){console.log("Updating Entity files...");var e=JSON.parse(f.default.readFileSync("../crm.json","utf8")).crm;l.default.ls("src/**/*.ts*").forEach((function(t){String(f.default.readFileSync(t)).match(new RegExp("specify Form onLoad function: ".concat(e.publisher_prefix,".").concat(e.namespace,".([^\\W]*).Form.onLoad")))})),l.default.ls("src/**/build.json").forEach((function(e){var t=e.split("/")[1];if(f.default.existsSync("src/".concat(t,"/").concat(t,".formContext.ts"))&&!f.default.existsSync("src/".concat(t,"/").concat(t,".form.ts"))){console.log("Adding ".concat(t,"/").concat(t,".form.ts..."));var n="src/".concat(t,"/").concat(t,".form.ts");l.default.cp("-r","".concat(__dirname,"/Entity/Entity.form.ts"),n),l.default.sed("-i",new RegExp("Entity","g"),t,n),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add",n]),console.log("Added ".concat(t,"/").concat(t,".form.ts"))}}))},e.updateFormFiles=function(){console.log("Updating Form files..."),l.default.ls("src/**/*.form.ts*").forEach((function(e){if(4===e.split("/").length)String(f.default.readFileSync(e)).match(new RegExp("export class ([a-zA-Z]*)Form {"))}))},e.updateSrcFolder=function(){console.log("Updating Annotation..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/src/Annotation"),"./src"),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","src/Annotation"]),console.log("Updating Http..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/src/Http"),"./src"),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","src/Http"]),console.log("Updating Translation..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/src/translation"),"./src"),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","src/translation"]),console.log("Updating util..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/src/util"),"./src"),l.default.test("-e","../.git")?(d.default.execFileSync("git",["add","src/util"]),d.default.execFileSync("git",["rm","src/util/FormUtil.spec.ts"])):l.default.rm("src/util/FormUtil.spec.ts"),console.log("Updating WebApi..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/src/WebApi"),"./src"),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","src/WebApi"])},e.updateCrmJson=function(){var e=JSON.parse(f.default.readFileSync("../crm.json","utf8"));l.default.cp("-R","".concat(__dirname,"/root/crm.json"),"../"),l.default.sed("-i",new RegExp("<%= publisher_prefix %>","ig"),e.crm.publisher_prefix,"../crm.json"),l.default.sed("-i",new RegExp("<%= environment %>","ig"),e.crm.url,"../crm.json"),l.default.sed("-i",new RegExp("<%= namespace %>","ig"),e.crm.namespace,"../crm.json"),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","../crm.json"]);var t=l.default.exec("hso-d365 --version").stdout.replace(/\n/gi,"");l.default.sed("-i",new RegExp("<%= version %>","ig"),t,"../crm.json"),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","../crm.json"])},e.updatePackageJson=function(){console.log("Updating package.json...");var e=JSON.parse(f.default.readFileSync("./package.json","utf8")),t=e.name,n=e.description,r=e.version,o=JSON.parse(f.default.readFileSync("../crm.json","utf8"));l.default.cp("-R","".concat(__dirname,"/root/Webresources/package.json"),".");var i=l.default.ls("package.json")[0];l.default.sed("-i",new RegExp("<%= projectname %>","ig"),t,i),l.default.sed("-i",new RegExp("<%= description %>","ig"),n,i),l.default.sed("-i",new RegExp("<%= publisher %>","ig"),o.crm.publisher_prefix,i),l.default.sed("-i",new RegExp("<%= version %>","ig"),r,i),console.log("Removing old npm packages. This may take a while..."),l.default.exec("npm prune"),l.default.exec("npm install")},e.updateWebpackConfig=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){return console.log("Updating webpack.config..."),l.default.cp("-R","".concat(__dirname,"/root/Webresources/webpack.config.ts"),"."),l.default.test("-e","../.git")&&d.default.execFileSync("git",["add","webpack.config.ts"]),[2]}))}))},e}();t.Update=p},8669:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeFormContext=void 0;var u=i(n(8489)),l=i(n(9896)),f=s(n(5317)),d=n(9594),p=s(n(3672)),h=function(){function e(e,t,n){this.bearer=e,this.entityName=t,this.entityLogicalName=n}return e.generateFormContext=function(t,n,r){return a(this,void 0,void 0,(function(){return c(this,(function(o){switch(o.label){case 0:return[4,new e(t,n,r).writeFormContextFile()];case 1:return o.sent(),[2]}}))}))},e.prototype.writeFormContextFile=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:return console.log("Generating ".concat(this.entityName,".formContext.ts")),e=this,[4,d.NodeApi.getAttributesMetadata(this.entityLogicalName,this.bearer)];case 1:return e.attributesMetadata=a.sent(),[4,this.getFormContextAttributesString()];case 2:return t=a.sent(),n="src/".concat(this.entityName,"/").concat(this.entityName,".formContext.ts"),u.cp("-r","".concat(__dirname,"/Entity/Entity.formContext.ts"),"src/".concat(this.entityName)),u.cp("-r","src/".concat(this.entityName,"/Entity.formContext.ts"),n),u.rm("-rf","src/".concat(this.entityName,"/Entity.formContext.ts")),u.sed("-i",new RegExp("Entity","g"),this.entityName,n),u.test("-e","../.git")&&f.default.execFileSync("git",["add",n]),r=String(l.readFileSync(n)),o="".concat(this.entityName,"FormContext {"),i=r.replace(o,"".concat(o,"\n").concat(t)),u.ShellString(i).to(n),console.log("Generated ".concat(this.entityName,".formContext.ts")),[2]}}))}))},e.prototype.getFormContextAttributesString=function(){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,l;return c(this,(function(c){switch(c.label){case 0:t="",n=0,r=this.attributesMetadata,c.label=1;case 1:return n<r.length?(o=r[n],i=o.SchemaName,[4,this.getXrmAttributeType(o)]):[3,4];case 2:(a=c.sent())&&(s=e.capitalize(i),u="    static get".concat(s,"Attribute(formContext: Xrm.FormContext): ").concat(a," {"),l="return formContext.getAttribute(".concat(this.entityName,"AttributeNames.").concat(s,");"),t+="".concat(u,"\n        ").concat(l,"\n    }\n")),c.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},e.prototype.getXrmAttributeType=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o;return c(this,(function(i){return t=e.AttributeType,n=e.AttributeTypeName,r=e.SchemaName,["String","Memo","Uniqueidentifier"].includes(t)?[2,"Xrm.Attributes.StringAttribute"]:["DateTime"].includes(t)?[2,"Xrm.Attributes.DateAttribute"]:["Boolean"].includes(t)?[2,"Xrm.Attributes.BooleanAttribute"]:["Picklist","Status","State"].includes(t)?(o="".concat(this.entityName,"_").concat(r,"Values"),[2,"Xrm.Attributes.OptionSetAttribute<".concat(o,">")]):["Integer","Double","BigInt","Decimal","Double","Money"].includes(t)?[2,"Xrm.Attributes.NumberAttribute"]:"MultiSelectPicklistType"===n.Value?[2,"Xrm.Attributes.MultiSelectOptionSetAttribute"]:["Lookup","Customer","Owner"].includes(t)?[2,"Xrm.Attributes.LookupAttribute"]:(console.log(p.default.blue("".concat(this.entityLogicalName," attribute ").concat(t," falls back to Xrm.Attributes.Attribute."))),[2,"Xrm.Attributes.Attribute"])}))}))},e.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e}();t.AttributeFormContext=h},1744:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.AttributeTypings=void 0;var u=i(n(8489)),l=i(n(9896)),f=s(n(3672)),d=s(n(5317)),p=n(9594),h=function(){function e(e,t,n){this.bearer=e,this.entityName=t,this.entityLogicalName=n}return e.generate=function(t,n,r){return a(this,void 0,void 0,(function(){return c(this,(function(o){switch(o.label){case 0:return[4,new e(t,n,r).writeTypingsFile()];case 1:return o.sent(),[2]}}))}))},e.prototype.writeTypingsFile=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:return console.log("Generating ".concat(this.entityName,".d.ts")),e=this,[4,p.NodeApi.getAttributesMetadata(this.entityLogicalName,this.bearer)];case 1:return e.attributesMetadata=a.sent(),[4,this.getTypingsAttributesString()];case 2:return t=a.sent(),n="src/".concat(this.entityName,"/").concat(this.entityName,".d.ts"),u.cp("-r","".concat(__dirname,"/Entity/Entity.d.ts"),"src/".concat(this.entityName)),u.cp("-r","src/".concat(this.entityName,"/Entity.d.ts"),n),u.rm("-rf","src/".concat(this.entityName,"/Entity.d.ts")),u.sed("-i",new RegExp("Entity","g"),this.entityName,n),u.test("-e","../.git")&&d.default.execFileSync("git",["add",n]),r=String(l.readFileSync(n)),o="interface ".concat(this.entityName,"Attributes {"),i=r.replace(o,"".concat(o,"\n").concat(t)),u.ShellString(i).to(n),console.log("Generated ".concat(this.entityName,".formContext.ts")),[2]}}))}))},e.prototype.getTypingsAttributesString=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:e="",t=0,n=this.attributesMetadata,a.label=1;case 1:return t<n.length?(r=n[t],o=r.LogicalName,[4,this.getXrmAttributeType(r)]):[3,4];case 2:(i=a.sent())&&(e+="        getAttribute(attributeName: '".concat(o,"'): ").concat(i,";\n")),a.label=3;case 3:return t++,[3,1];case 4:return[2,e]}}))}))},e.prototype.getXrmAttributeType=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return c(this,(function(o){return t=e.AttributeType,n=e.SchemaName,["String","Memo","Uniqueidentifier"].includes(t)?[2,"Xrm.Attributes.StringAttribute"]:["DateTime"].includes(t)?[2,"Xrm.Attributes.DateAttribute"]:["Boolean"].includes(t)?[2,"Xrm.Attributes.BooleanAttribute"]:["Picklist","Status","State"].includes(t)?(r="".concat(this.entityName,"_").concat(n,"Values"),[2,"Xrm.Attributes.OptionSetAttribute<".concat(r,">")]):["Integer","Double","BigInt","Decimal","Double","Money"].includes(t)?[2,"Xrm.Attributes.NumberAttribute"]:["Lookup","Customer","Owner"].includes(t)?[2,"Xrm.Attributes.LookupAttribute"]:(console.log(f.default.blue("".concat(this.entityLogicalName," attribute ").concat(t," falls back to Xrm.Attributes.Attribute."))),[2,"Xrm.Attributes.Attribute"])}))}))},e}();t.AttributeTypings=h},1218:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ControlFormContext=void 0;var u=i(n(8489)),l=i(n(9896)),f=s(n(5317)),d=n(9594),p=s(n(3672)),h=function(){function e(e,t,n){this.bearer=e,this.entityName=t,this.entityLogicalName=n}return e.generateFormContext=function(t,n,r,o){return a(this,void 0,void 0,(function(){return c(this,(function(i){switch(i.label){case 0:return[4,new e(t,n,r).writeFormContextFile(o)];case 1:return i.sent(),[2]}}))}))},e.prototype.writeFormContextFile=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return t=e.name.replace(/\W/g,""),console.log("Generating ".concat(t,"/").concat(t,".formContext.ts")),n=this,[4,d.NodeApi.getAttributesMetadata(this.entityLogicalName,this.bearer)];case 1:return n.attributesMetadata=c.sent(),[4,this.getFormContextControlsString(e)];case 2:return r=c.sent(),o="src/".concat(this.entityName,"/").concat(t,"/").concat(t,".formContext.ts"),u.cp("-r","".concat(__dirname,"/Entity/form/Entity.formContext.ts"),"src/".concat(this.entityName,"/").concat(t)),u.cp("-r","src/".concat(this.entityName,"/").concat(t,"/Entity.formContext.ts"),o),u.rm("-rf","src/".concat(this.entityName,"/").concat(t,"/Entity.formContext.ts")),u.sed("-i",new RegExp("Entity","g"),this.entityName,o),u.sed("-i",new RegExp("FormName","g"),t,o),u.test("-e","../.git")&&f.default.execFileSync("git",["add",o]),i=String(l.readFileSync(o)),a=i.match(new RegExp("".concat(t,"FormContext extends ").concat(this.entityName,"Form {"),"ig"))[0],s=i.replace(a,"".concat(a,"\n").concat(r)),u.ShellString(s).to(o),console.log("Generated ".concat(t,"/").concat(t,".formContext.ts")),[2]}}))}))},e.prototype.getFormContextControlsString=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:return n="",e.usedControlNames=[],r=JSON.parse(t.formjson),o=n,[4,this.getTabsString(r.Tabs.$values)];case 1:return n=o+c.sent(),i=n,[4,this.getControlsString(r.Header.Controls.$values)];case 2:return n=i+c.sent(),a=n,[4,this.getControlsString(r.Footer.Controls.$values)];case 3:return[2,n=a+c.sent()]}}))}))},e.prototype.getTabsString=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i,a,s,u,l,f;return c(this,(function(c){switch(c.label){case 0:n="",e.usedSectionNames=[],r=0,o=t,c.label=1;case 1:return r<o.length?(i=o[r],(a=i.Name)&&(s=e.capitalize(a.replace(/\W/g,"")),u="    static get".concat(s,"Tab(formContext: Xrm.FormContext): Xrm.Controls.Tab {"),l="return formContext.ui.tabs.get('".concat(a,"');"),n+="".concat(u,"\n        ").concat(l,"\n    }\n")),f=n,[4,this.getColumnsString(i,i.Columns.$values)]):[3,4];case 2:n=f+c.sent(),c.label=3;case 3:return r++,[3,1];case 4:return[2,n]}}))}))},e.prototype.getColumnsString=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:n="",r=0,o=t,c.label=1;case 1:return r<o.length?(i=o[r],a=n,[4,this.getSectionsString(e,i.Sections.$values)]):[3,4];case 2:n=a+c.sent(),c.label=3;case 3:return r++,[3,1];case 4:return[2,n]}}))}))},e.prototype.getSectionsString=function(t,n){return a(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,f,d;return c(this,(function(c){switch(c.label){case 0:r="",o=0,i=n,c.label=1;case 1:return o<i.length?(a=i[o],(s=a.Name)&&(u=e.capitalize(s.replace(/\W/g,"")),e.usedSectionNames.includes(u)||(e.usedSectionNames.push(u),l="    static get".concat(u,"Section(formContext: Xrm.FormContext): Xrm.Controls.Section {"),f="return formContext.ui.tabs.get('".concat(t.Name,"').sections.get('").concat(s,"');"),r+="".concat(l,"\n        ").concat(f,"\n    }\n"))),d=r,[4,this.getRowsString(a.Rows.$values)]):[3,4];case 2:r=d+c.sent(),c.label=3;case 3:return o++,[3,1];case 4:return[2,r]}}))}))},e.prototype.getRowsString=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:t="",n=0,r=e,c.label=1;case 1:return n<r.length?(o=r[n],i=o.Cells.$values.map((function(e){return e.Control})),a=t,[4,this.getControlsString(i)]):[3,4];case 2:t=a+c.sent(),c.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},e.prototype.getControlsString=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i,a,s;return c(this,(function(u){switch(u.label){case 0:n="",r=function(t){var r,i,a,s,u,l,f,d,p;return c(this,(function(c){switch(c.label){case 0:return r=t.Type,i=t.Id,a=t.DataFieldName,i?(s=a&&o.attributesMetadata.find((function(e){return e.LogicalName===a})),[4,o.getXrmControlType(s,r,i)]):[3,2];case 1:(u=c.sent())&&(l=a===i?e.capitalize((null==s?void 0:s.SchemaName)||i):e.capitalize(i),e.usedControlNames.includes(l)?console.log("Duplicate control name found: '".concat(l,"'")):(e.usedControlNames.push(l),f=l.replace(/\W/g,""),d="    static get".concat(f,"Control(formContext: Xrm.FormContext): ").concat(u," {"),p="return formContext.getControl('".concat(i,"');"),n+="".concat(d,"\n        ").concat(p,"\n    }\n"))),c.label=2;case 2:return[2]}}))},o=this,i=0,a=t,u.label=1;case 1:return i<a.length?(s=a[i],[5,r(s)]):[3,4];case 2:u.sent(),u.label=3;case 3:return i++,[3,1];case 4:return[2,n]}}))}))},e.prototype.getXrmControlType=function(e,t,n){return a(this,void 0,void 0,(function(){var r,o;return c(this,(function(i){if(e){if(r=e.AttributeType,o=e.AttributeTypeName,["String","Memo","Customer","Owner","Uniqueidentifier"].includes(r))return[2,"Xrm.Controls.StringControl"];if(["DateTime"].includes(r))return[2,"Xrm.Controls.DateControl"];if("MultiSelectPicklistType"===o.Value)return[2,"Xrm.Controls.MultiSelectOptionSetControl"];if(["Boolean","Picklist"].includes(r))return[2,"Xrm.Controls.OptionSetControl"];if(["Lookup"].includes(r))return[2,"Xrm.Controls.LookupControl"];if(["Integer","Double","BigInt","Decimal","Double","Money"].includes(r))return[2,"Xrm.Controls.NumberControl"]}return 4===t?[2,"Xrm.Controls.OptionSetControl"]:5===t?[2,"Xrm.Controls.GridControl"]:6===t?[2,"Xrm.Controls.FramedControl"]:(14===t||console.log(p.default.blue("".concat(this.entityLogicalName," control ").concat(n," type '").concat(t,"' falls back to Xrm.Controls.StandardControl."))),[2,"Xrm.Controls.StandardControl"])}))}))},e.capitalize=function(e){return void 0===e&&(e=""),e.charAt(0).toUpperCase()+e.slice(1)},e}();t.ControlFormContext=h},3474:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomApis=void 0;var u=i(n(8489)),l=s(n(9896)),f=n(2287),d=n(3267),p=n(1251),h=n(3919),b=n(4409),y=function(){function e(e){this.bearer=e}return e.prototype.generate=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return console.log("Generating Custom Apis"),[4,this.writeCustomApisFile()];case 1:return e.sent(),console.log("Generated Custom Apis"),[2]}}))}))},e.prototype.writeCustomApisFile=function(){return a(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:return console.log("Generating CustomApis/CustomApis.ts"),[4,this.getCustomApisString()];case 1:return e=r.sent(),u.cp("-r","".concat(__dirname,"/CustomApis"),"src"),t="src/CustomApis/CustomApis.ts",n=String(l.default.readFileSync(t)),u.ShellString(n+e).to(t),u.exec("git add src/CustomApis"),console.log("Generated CustomApis/CustomApis.ts"),[2]}}))}))},e.prototype.getCustomApisString=function(){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,l,f,d,p,h,b;return c(this,(function(c){switch(c.label){case 0:return t="",[4,this.getCustomApis()];case 1:n=c.sent(),r=0,o=n,c.label=2;case 2:return r<o.length?(i=o[r],a=e.capitalize(i.uniquename),[4,this.getRequestParameters(i)]):[3,6];case 3:for(s=c.sent(),t+="// eslint-disable-next-line @typescript-eslint/no-empty-interface\n",t+="interface ".concat(a,"Request {\n"),u=0,l=s;u<l.length;u++)f=l[u],t+="    // ".concat(f.name,"\n"),t+="    // ".concat(f.description,"\n"),t+="    // ".concat(f.displayname,"\n"),t+="    ".concat(f.uniquename).concat(f.isoptional?"?":"",": ").concat(e.getTypeString(f.type),";\n\n");return 0===s.length&&(t+="    //\n"),t+="}\n",[4,this.getResponseProperties(i)];case 4:for(d=c.sent(),t+="// eslint-disable-next-line @typescript-eslint/no-empty-interface\n",t+="interface ".concat(a,"Response {\n"),p=0,h=d;p<h.length;p++)b=h[p],t+="    // ".concat(b.name,"\n"),t+="    // ".concat(b.description,"\n"),t+="    // ".concat(b.displayname,"\n"),t+="    ".concat(b.uniquename,": ").concat(e.getTypeString(b.type),";\n\n");t+="}\n",t+="// ".concat(i.name,"\n"),t+="// ".concat(i.description,"\n"),t+="// ".concat(i.displayname,"\n"),t+="export const ".concat(a," = async (request: ").concat(a,"Request): Promise<").concat(a,"Response> => {\n"),t+="    return WebApi.executeAction('".concat(i.uniquename,"', request);\n"),t+="};\n\n",c.label=5;case 5:return r++,[3,2];case 6:return t&&(t+="\n"),[2,t]}}))}))},e.prototype.getCustomApis=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,u;return c(this,(function(c){switch(c.label){case 0:return e=JSON.parse(l.default.readFileSync("./crm.json","utf8")),t=e.crm.solution_name_generate,[4,f.SolutionService.getSolution(t,["solutionid"],this.bearer)];case 1:return n=c.sent(),[4,b.SolutionComponentSummaryService.retrieveMultipleRecords({select:["msdyn_objectid"],filters:[{conditions:[{attribute:"msdyn_solutionid",value:n.solutionid}]},{type:"or",conditions:[{attribute:"msdyn_componenttype",value:10051}]}]},this.bearer)];case 2:for(r=c.sent(),o=[],i=0,a=r;i<a.length;i++)s=a[i],u=s.msdyn_objectid,o.push({attribute:"customapiid",value:u});return[2,d.CustomApiService.retrieveMultipleRecords({select:["customapiid","description","displayname","name","solutionid","uniquename"],filters:[{type:"or",conditions:o}]},this.bearer)]}}))}))},e.prototype.getRequestParameters=function(e){return p.CustomApiRequestParameterService.retrieveMultipleRecords({select:["customapirequestparameterid","description","displayname","name","solutionid","uniquename","isoptional","type"],filters:[{conditions:[{attribute:"_customapiid_value",value:e.customapiid}]}]},this.bearer)},e.prototype.getResponseProperties=function(e){return h.CustomApiResponsePropertyService.retrieveMultipleRecords({select:["customapiresponsepropertyid","description","displayname","name","solutionid","uniquename","type"],filters:[{conditions:[{attribute:"_customapiid_value",value:e.customapiid}]}]},this.bearer)},e.getTypeString=function(e){return 0===e?"boolean":1===e?"Date":[2,6,7].includes(e)?"number":[3].includes(e)?"Model":[4].includes(e)?"Model[]":[5,8,9].includes(e)?"any":[10,12].includes(e)?"string":[11].includes(e)?"string[]":void 0},e.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e}();t.CustomApis=y},2915:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Entity=void 0;var u=s(n(3672)),l=i(n(8489)),f=s(n(9937)),d=i(n(9896)),p=s(n(5317)),h=n(9594),b=n(5187),y=n(8017),m=n(8669),g=n(4638),v=n(1744),w=function(){function e(e,t,n,r){this.bearer=e,this.entityName=t.replaceAll(/\W/g,""),this.entityLogicalName=n,this.options=r}return e.prototype.generate=function(){return a(this,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return t.trys.push([0,9,,12]),[4,this.generateEntityFiles()];case 1:return t.sent(),console.log("Generating files for Entity '".concat(this.entityName,"'")),console.log("Using entityLogicalName '".concat(this.entityLogicalName,"'")),[4,new b.Model(this.bearer,this.entityName,this.entityLogicalName).generate()];case 2:return t.sent(),[4,y.Enum.generateEnum(this.bearer,this.entityName,this.entityLogicalName)];case 3:return t.sent(),this.options.skipForms?[3,7]:[4,v.AttributeTypings.generate(this.bearer,this.entityName,this.entityLogicalName)];case 4:return t.sent(),[4,m.AttributeFormContext.generateFormContext(this.bearer,this.entityName,this.entityLogicalName)];case 5:return t.sent(),[4,g.Form.generateFormFiles(this.bearer,this.entityName,this.entityLogicalName)];case 6:return t.sent(),[3,8];case 7:console.log("Skip generate form files"),t.label=8;case 8:return console.log("Generating files finished"),[3,12];case 9:return e=t.sent(),console.log(u.default.red("Form.generateFormFiles failed for ".concat(this.entityName," ").concat(JSON.stringify(e)))),[4,this.wait()];case 10:return t.sent(),console.log(u.default.red("New try for failed ".concat(this.entityName))),[4,this.generate()];case 11:return t.sent(),[3,12];case 12:return[2]}}))}))},e.prototype.wait=function(){return new Promise((function(e){setTimeout((function(){e()}),5e3)}))},e.prototype.generateEntityFiles=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o;return c(this,(function(i){switch(i.label){case 0:return e="src/".concat(this.entityName,"/").concat(this.entityName,".service.ts"),l.test("-f",e)?[3,7]:this.entityLogicalName?[3,2]:[4,f.default.prompt([{type:"input",name:"entityLogicalName",message:"Entity LogicalName:"}])];case 1:t=i.sent(),this.entityLogicalName=t.entityLogicalName,i.label=2;case 2:return i.trys.push([2,4,,5]),[4,h.NodeApi.getEntityDefinition(this.entityLogicalName,this.bearer,["PrimaryIdAttribute"])];case 3:return i.sent(),[3,5];case 4:throw n=i.sent(),console.log(u.default.red("Failed: Entity ".concat(this.entityName," has no LogicalName ").concat(this.entityLogicalName))),n;case 5:return l.mkdir("src/".concat(this.entityName)),[4,this.addEntityFiles(this.entityName)];case 6:return i.sent(),[3,8];case 7:r=String(d.readFileSync(e)),o=r.match(new RegExp("static logicalName = '([a-zA-Z0-9_]*)';")),this.entityLogicalName=o[1],console.log(u.default.magenta("Entity ".concat(this.entityName," already exist"))),i.label=8;case 8:return[2]}}))}))},e.prototype.addEntityFiles=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.addFormFile(e)];case 1:return t.sent(),[4,this.addServiceFile(e)];case 2:return t.sent(),[4,this.addBuildFile()];case 3:return t.sent(),[2]}}))}))},e.prototype.addFormFile=function(e){return a(this,void 0,void 0,(function(){var t;return c(this,(function(n){return console.log("Adding ".concat(e,"/").concat(e,".form.ts...")),t="src/".concat(this.entityName,"/").concat(this.entityName,".form.ts"),l.cp("-r","".concat(__dirname,"/Entity/Entity.form.ts"),t),l.sed("-i",new RegExp("Entity","g"),e,t),l.test("-e","../.git")&&p.default.execFileSync("git",["add",t]),console.log("Added ".concat(e,"/").concat(e,".form.ts")),[2]}))}))},e.prototype.addServiceFile=function(e){return a(this,void 0,void 0,(function(){var t;return c(this,(function(n){return console.log("Adding ".concat(e,"/").concat(e,".service.ts...")),t="src/".concat(this.entityName,"/").concat(this.entityName,".service.ts"),l.cp("-r","".concat(__dirname,"/Entity/Entity.service.ts"),t),l.sed("-i",new RegExp("EntityLogicalName","g"),this.entityLogicalName,t),l.sed("-i",new RegExp("Entity","g"),e,t),l.test("-e","../.git")&&p.default.execFileSync("git",["add",t]),console.log("Added ".concat(e,"/").concat(e,".service.ts")),[2]}))}))},e.prototype.addBuildFile=function(){return a(this,void 0,void 0,(function(){var e;return c(this,(function(t){return console.log("Adding ".concat(this.entityName,"/build.json")),e="src/".concat(this.entityName,"/build.json"),l.cp("-r","".concat(__dirname,"/Entity/build.json"),e),l.test("-e","../.git")&&p.default.execFileSync("git",["add",e]),console.log("Added ".concat(this.entityName,"/build.json")),[2]}))}))},e}();t.Entity=w},8017:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Enum=void 0;var u=i(n(8489)),l=i(n(9896)),f=n(9594),d=n(3991),p=s(n(5317)),h=function(){function e(e,t,n){this.bearer=e,this.entityName=t,this.entityLogicalName=n}return e.generateEnum=function(t,n,r){return a(this,void 0,void 0,(function(){return c(this,(function(o){switch(o.label){case 0:return[4,new e(t,n,r).writeEnumFile()];case 1:return o.sent(),[2]}}))}))},e.prototype.writeEnumFile=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:return console.log("Generating ".concat(this.entityName,".enum.ts")),[4,this.getAttributeNamesEnumString()];case 1:return e=a.sent(),[4,this.getNavigationPropertyNamesString()];case 2:return t=a.sent(),[4,this.getSavedQueriesString()];case 3:return n=a.sent(),[4,this.getEnumStrings()];case 4:return r=a.sent(),o="src/".concat(this.entityName,"/").concat(this.entityName,".enum.ts"),u.cp("-r","".concat(__dirname,"/Entity/Entity.enum.ts"),"src/".concat(this.entityName)),u.cp("-r","src/".concat(this.entityName,"/Entity.enum.ts"),o),u.rm("-rf","src/".concat(this.entityName,"/Entity.enum.ts")),u.test("-e","../.git")&&p.default.execFileSync("git",["add",o]),i=String(l.readFileSync(o)),console.log("Generated ".concat(this.entityName,".enum.ts")),u.ShellString(i+e+t+r+n).to(o),[2]}}))}))},e.prototype.getSavedQueriesString=function(){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,l;return c(this,(function(c){switch(c.label){case 0:return t="",t+="export const ".concat(this.entityName.charAt(0).toLowerCase()).concat(this.entityName.slice(1),"Views = {\n"),[4,d.SavedQueryService.retrieveMultipleRecords({select:["savedqueryid","name","returnedtypecode"],filters:[{conditions:[{attribute:"returnedtypecode",value:this.entityLogicalName}]}]},this.bearer)];case 1:for(n=c.sent(),r=[],o=0,i=n;o<i.length;o++)(a=i[o])&&a.returnedtypecode===this.entityLogicalName&&(s=a.name,u=a.savedqueryid,l=s.replace(/\W/g,""),r.includes(l)&&(l+=u.replace(/\W/g,"")),r.push(l),t+="    ".concat(e.capitalize(l),": {\n"),t+="        name: `".concat(s,"`,\n"),t+="        savedqueryid: '".concat(u,"',\n"),t+="    },\n");return[2,t+="};\n"]}}))}))},e.prototype.getNavigationPropertyNamesString=function(){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:return t="",[4,f.NodeApi.getManyToOneMetadatas(this.entityLogicalName,this.bearer)];case 1:for(n=c.sent(),t+="export enum ".concat(this.entityName,"NavigationPropertyNames {\n"),r=0,o=n;r<o.length;r++)i=o[r],a=i.ReferencingEntityNavigationPropertyName,t+="    ".concat(e.capitalize(a)," = '").concat(a,"',\n");return[2,t+="}\n"]}}))}))},e.prototype.getAttributeNamesEnumString=function(){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return t="",[4,f.NodeApi.getAttributesMetadata(this.entityLogicalName,this.bearer)];case 1:for(n=c.sent(),t+="export enum ".concat(this.entityName,"AttributeNames {\n"),r=0,o=n;r<o.length;r++)i=o[r],a=i.LogicalName,s=i.SchemaName,t+="    ".concat(e.capitalize(s)," = '").concat(a,"',\n");return[2,t+="}\n"]}}))}))},e.prototype.getEnumStrings=function(){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,l,d,p,h,b,y,m;return c(this,(function(c){switch(c.label){case 0:return t="",[4,f.NodeApi.getAttributesMetadata(this.entityLogicalName,this.bearer)];case 1:n=c.sent(),r=0,o=n,c.label=2;case 2:return r<o.length?(i=o[r],a=i.AttributeType,s=i.SchemaName,u=i.AttributeTypeName,["Picklist","State","Status"].includes(a)||"MultiSelectPicklistType"===u.Value?[4,this.getOptionSet(i)]:[3,4]):[3,5];case 3:if(!(l=c.sent()).IsGlobal){for(d=e.capitalize(s),t+="export enum ".concat(d," {\n"),p=[],h=0,b=l.Options;h<b.length;h++)y=b[h],m=y.Label.UserLocalizedLabel.Label.replace(/\W/g,""),p.includes(m)&&(m+=y.Value),p.push(m),m.charAt(0).match(/^[a-zA-Z]/)||(m="'".concat(m,"'")),t+="    ".concat(m," = ").concat(y.Value,",\n");t+="}\n"}c.label=4;case 4:return r++,[3,2];case 5:return t&&(t+="\n"),[2,t]}}))}))},e.prototype.getOptionSet=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return c(this,(function(o){switch(o.label){case 0:return t=e.AttributeType,n=e.LogicalName,"Picklist"!==t?[3,2]:[4,f.NodeApi.getPicklistOptionSet(this.entityLogicalName,n,this.bearer)];case 1:return r=o.sent(),[3,8];case 2:return"State"!==t?[3,4]:[4,f.NodeApi.getStateOptionSet(this.entityLogicalName,this.bearer)];case 3:return r=o.sent(),[3,8];case 4:return"Status"!==t?[3,6]:[4,f.NodeApi.getStatusOptionSet(this.entityLogicalName,this.bearer)];case 5:return r=o.sent(),[3,8];case 6:return[4,f.NodeApi.getMultiSelectPicklistAttributeMetadata(this.entityLogicalName,n,this.bearer)];case 7:r=o.sent(),o.label=8;case 8:return[2,r]}}))}))},e.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e}();t.Enum=h},935:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentVariable=void 0;var s=i(n(8489)),u=i(n(9896)),l=n(1071),f=n(2287),d=n(1547),p=n(4409),h=function(){function e(e){this.bearer=e}return e.prototype.generate=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return console.log("Generating EnvironmentVariable"),[4,this.writeEnvironmentVariablesFiles()];case 1:return e.sent(),console.log("Generated EnvironmentVariable"),[2]}}))}))},e.prototype.writeEnvironmentVariablesFiles=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o;return c(this,(function(i){switch(i.label){case 0:return[4,this.getEnvironmentVariablesString()];case 1:return e=i.sent(),s.cp("-r","".concat(__dirname,"/EnvironmentVariable"),"src"),t="src/EnvironmentVariable/EnvironmentVariable.service.ts",n=String(u.readFileSync(t)),r="'environmentvariablevalue';",o=n.replace(r,"".concat(r,"\n\n").concat(e)),s.ShellString(o).to(t),s.exec("git add src/EnvironmentVariable"),[2]}}))}))},e.prototype.getEnvironmentVariablesString=function(){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,f,d,p,h;return c(this,(function(c){switch(c.label){case 0:return t="",[4,this.getEnvironmentVariableDefinitions()];case 1:return n=c.sent(),[4,l.PublisherService.getPublisher(this.bearer)];case 2:for(r=c.sent(),o=r.customizationprefix,i=0,a=n;i<a.length;i++)s=a[i],u=e.getEnvironmentType(s),f=e.capitalize(s.schemaname.replace("".concat(o,"_"),"")),d="    public static async get".concat(f,"(): Promise<").concat(u,"> {"),p="const environmentVariableValue = await EnvironmentVariableService.getEnvironmentVariableValue('".concat(s.schemaname,"');"),h=e.getReturnString(s),t+="".concat(d,"\n        ").concat(p,"\n        ").concat(h,"\n    }\n\n");return[2,t]}}))}))},e.getReturnString=function(e){if(1e8===e.type)return"return environmentVariableValue ? environmentVariableValue.value : '".concat(e.defaultvalue,"';");if(100000001===e.type)return"return environmentVariableValue ? parseFloat(environmentVariableValue.value) : ".concat(e.defaultvalue,";");if(100000002===e.type)return"return environmentVariableValue ? environmentVariableValue.value === 'yes' : ".concat("yes"===e.defaultvalue,";");if(100000003===e.type){var t="// eslint-disable-next-line quotes\n        ";return t+="return environmentVariableValue ? JSON.parse(environmentVariableValue.value) : ".concat(e.defaultvalue,";")}if(100000004===e.type){t="// Not supported or go ahead with the value\n        ";return t+="return environmentVariable ? environmentVariableValue.value as unknown : null"}},e.getEnvironmentType=function(e){return 1e8===e.type?"string":100000001===e.type?"number":100000002===e.type?"boolean":100000003===e.type?"JSON":100000004===e.type?"unknown":void 0},e.prototype.getEnvironmentVariableDefinitions=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,l,h;return c(this,(function(c){switch(c.label){case 0:return e=[],t=JSON.parse(u.readFileSync("./crm.json","utf8")),n=t.crm.solution_name_generate,[4,f.SolutionService.getSolution(n,["solutionid"],this.bearer)];case 1:return r=c.sent(),[4,p.SolutionComponentSummaryService.retrieveMultipleRecords({select:["msdyn_objectid"],filters:[{conditions:[{attribute:"msdyn_solutionid",value:r.solutionid}]},{type:"or",conditions:[{attribute:"msdyn_componenttype",value:380}]}]},this.bearer)];case 2:o=c.sent(),i=0,a=o,c.label=3;case 3:return i<a.length?(s=a[i],l=s.msdyn_objectid,[4,d.EnvironmentVariableDefinitionService.retrieveMultipleRecords({select:["defaultvalue","schemaname","type"],filters:[{conditions:[{attribute:"environmentvariabledefinitionid",value:l}]}]},this.bearer)]):[3,6];case 4:h=c.sent(),e.push(h[0]),c.label=5;case 5:return i++,[3,3];case 6:return[2,e]}}))}))},e.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e}();t.EnvironmentVariable=h},4638:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Form=void 0;var u=i(n(8489)),l=s(n(9896)),f=s(n(5317)),d=n(1218),p=n(4935),h=n(6264),b=n(2287),y=n(4409),m=function(){function e(e,t,n){this.bearer=e,this.entityName=t,this.entityLogicalName=n}return e.generateFormFiles=function(t,n,r){return a(this,void 0,void 0,(function(){return c(this,(function(o){switch(o.label){case 0:return[4,new e(t,n,r).writeFormFiles()];case 1:return o.sent(),[2]}}))}))},e.prototype.writeFormFiles=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:return[4,this.getSystemForms()];case 1:e=a.sent(),t=0,n=e,a.label=2;case 2:return t<n.length?(r=n[t],o=r.name.replace(/\W/g,""),i="src/".concat(this.entityName,"/").concat(o),u.test("-d",i)?[3,5]:(u.mkdir(i),[4,this.addEntityFiles(r)])):[3,9];case 3:return a.sent(),[4,this.updateBuildFile(r)];case 4:return a.sent(),[3,5];case 5:return[4,h.FormTypings.generate(this.bearer,this.entityName,this.entityLogicalName,r)];case 6:return a.sent(),[4,d.ControlFormContext.generateFormContext(this.bearer,this.entityName,this.entityLogicalName,r)];case 7:a.sent(),a.label=8;case 8:return t++,[3,2];case 9:return[2]}}))}))},e.prototype.addEntityFiles=function(e){return a(this,void 0,void 0,(function(){return c(this,(function(t){switch(t.label){case 0:return[4,this.addEntityFile(e)];case 1:return t.sent(),[4,this.addEntityFormFile(e)];case 2:return t.sent(),[2]}}))}))},e.prototype.addEntityFile=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a;return c(this,(function(c){return t=e.name.replace(/\W/g,""),console.log("Adding ".concat(this.entityName,"/").concat(t,"/").concat(t,".ts")),n="src/".concat(this.entityName,"/").concat(t,"/").concat(t,".ts"),r=JSON.parse(l.default.readFileSync("../crm.json","utf8")),o=r.crm,i=o.namespace,a=o.publisher_prefix,u.cp("-r","".concat(__dirname,"/Entity/form/Entity.ts"),n),u.sed("-i",new RegExp("Entity","g"),t,n),u.sed("-i",new RegExp("<%= publisher %>","ig"),a,n),u.sed("-i",new RegExp("<%= namespace %>","ig"),i,n),u.sed("-i",new RegExp("<%= formname %>","ig"),t,n),u.sed("-i",new RegExp("<%= fullformname %>","ig"),e.name,n),u.sed("-i",new RegExp("<%= entity %>","ig"),this.entityName,n),u.test("-e","../.git")&&f.default.execFileSync("git",["add",n]),console.log("Added ".concat(this.entityName,"/").concat(t,"/").concat(t,".ts")),[2]}))}))},e.prototype.addEntityFormFile=function(e){return a(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){return t=e.name.replace(/\W/g,""),console.log("Adding ".concat(this.entityName,"/").concat(t,"/").concat(t,".form.ts")),n="src/".concat(this.entityName,"/").concat(t,"/").concat(t,".form.ts"),u.cp("-r","".concat(__dirname,"/Entity/form/Entity.form.ts"),n),u.sed("-i",new RegExp("Entity","g"),t,n),u.test("-e","../.git")&&f.default.execFileSync("git",["add",n]),console.log("Added ".concat(this.entityName,"/").concat(t,"/").concat(t,".form.ts")),[2]}))}))},e.prototype.updateBuildFile=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o;return c(this,(function(i){return t=e.name.replace(/\W/g,""),console.log("Updating ".concat(this.entityName,"/build.json")),n="src/".concat(this.entityName,"/build.json"),r=String(l.default.readFileSync(n)),(o=JSON.parse(r)).forms.find((function(e){return e.name===t}))||(o.forms.push({name:t,build:!1}),u.ShellString(JSON.stringify(o,null,2)).to(n),u.test("-e","../.git")&&f.default.execFileSync("git",["add",n])),console.log("Updated ".concat(this.entityName,"/build.json")),[2]}))}))},e.prototype.getSystemForms=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,u,f,d,h;return c(this,(function(c){switch(c.label){case 0:return e=JSON.parse(l.default.readFileSync("./crm.json","utf8")),t=e.crm,n=t.solution_name_generate,r=t.only_solution_forms,o=[{type:"or",conditions:[{attribute:"msdyn_componenttype",value:24},{attribute:"msdyn_componenttype",value:60}]},{conditions:[{attribute:"msdyn_primaryentityname",value:this.entityLogicalName}]}],r?[4,b.SolutionService.getSolution(n,["solutionid"],this.bearer)]:[3,2];case 1:i=c.sent(),o.push({conditions:[{attribute:"msdyn_solutionid",value:i.solutionid}]}),c.label=2;case 2:return[4,y.SolutionComponentSummaryService.retrieveMultipleRecords({select:["msdyn_objectid"],filters:o},this.bearer)];case 3:for(a=c.sent(),s=[],u=0,f=a;u<f.length;u++)d=f[u],h=d.msdyn_objectid,s.push({attribute:"formid",value:h});return s.length>0?[2,p.SystemFormService.retrieveMultipleRecords({select:["formid","description","name","objecttypecode","formjson"],filters:[{type:"or",conditions:s},{type:"and",conditions:[{attribute:"type",operator:"ne",value:6}]}]},this.bearer)]:[2,[]]}}))}))},e}();t.Form=m},6264:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.FormTypings=void 0;var u=i(n(8489)),l=i(n(9896)),f=n(9594),d=s(n(3672)),p=function(){function e(e,t,n){this.bearer=e,this.entityName=t,this.entityLogicalName=n}return e.generate=function(t,n,r,o){return a(this,void 0,void 0,(function(){return c(this,(function(i){switch(i.label){case 0:return[4,new e(t,n,r).writeTypingsFile(o)];case 1:return i.sent(),[2]}}))}))},e.prototype.writeTypingsFile=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:return console.log("Updating ".concat(this.entityName,".d.ts")),t=this,[4,f.NodeApi.getAttributesMetadata(this.entityLogicalName,this.bearer)];case 1:return t.attributesMetadata=c.sent(),n="declare namespace ".concat(this.entityName," {\n"),r=e.name.replace(/\W/g,""),n+="    type ".concat(r," = Omit<").concat(this.entityName,".AttributesFormContext, 'getControl'> & ").concat(this.entityName).concat(r,"Controls;\n\n"),n+="    interface ".concat(this.entityName).concat(r,"Controls {\n"),o=n,[4,this.getFormTypingsControlsString(e)];case 2:return n=o+c.sent(),n+="    }\n}",i="src/".concat(this.entityName,"/").concat(this.entityName,".d.ts"),a=String(l.readFileSync(i)),u.ShellString("".concat(a,"\n").concat(n)).to(i),console.log("Updated ".concat(this.entityName,".d.ts")),[2]}}))}))},e.prototype.getFormTypingsControlsString=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:return n="",e.usedControlNames=[],r=JSON.parse(t.formjson),o=n,[4,this.getTabsString(r.Tabs.$values)];case 1:return n=o+c.sent(),i=n,[4,this.getControlsString(r.Header.Controls.$values)];case 2:return n=i+c.sent(),a=n,[4,this.getControlsString(r.Footer.Controls.$values)];case 3:return[2,n=a+c.sent()]}}))}))},e.prototype.getTabsString=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:t="",n=0,r=e,a.label=1;case 1:return n<r.length?(o=r[n],i=t,[4,this.getColumnsString(o,o.Columns.$values)]):[3,4];case 2:t=i+a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},e.prototype.getColumnsString=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:n="",r=0,o=t,c.label=1;case 1:return r<o.length?(i=o[r],a=n,[4,this.getSectionsString(e,i.Sections.$values)]):[3,4];case 2:n=a+c.sent(),c.label=3;case 3:return r++,[3,1];case 4:return[2,n]}}))}))},e.prototype.getSectionsString=function(e,t){return a(this,void 0,void 0,(function(){var e,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:e="",n=0,r=t,a.label=1;case 1:return n<r.length?(o=r[n],i=e,[4,this.getRowsString(o.Rows.$values)]):[3,4];case 2:e=i+a.sent(),a.label=3;case 3:return n++,[3,1];case 4:return[2,e]}}))}))},e.prototype.getRowsString=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:t="",n=0,r=e,c.label=1;case 1:return n<r.length?(o=r[n],i=o.Cells.$values.map((function(e){return e.Control})),a=t,[4,this.getControlsString(i)]):[3,4];case 2:t=a+c.sent(),c.label=3;case 3:return n++,[3,1];case 4:return[2,t]}}))}))},e.prototype.getControlsString=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i,a,s;return c(this,(function(u){switch(u.label){case 0:n="",r=function(t){var r,i,a,s,u;return c(this,(function(c){switch(c.label){case 0:return r=t.Type,i=t.Id,a=t.DataFieldName,i?(s=a&&o.attributesMetadata.find((function(e){return e.LogicalName===a})),[4,o.getXrmControlType(s,r,i)]):[3,2];case 1:(u=c.sent())&&(e.usedControlNames.includes(i)?console.log("Duplicate control name found: '".concat(i,"'")):(e.usedControlNames.push(i),n+="        getControl(controlName: '".concat(i,"'): ").concat(u,";\n"))),c.label=2;case 2:return[2]}}))},o=this,i=0,a=t,u.label=1;case 1:return i<a.length?(s=a[i],[5,r(s)]):[3,4];case 2:u.sent(),u.label=3;case 3:return i++,[3,1];case 4:return[2,n]}}))}))},e.prototype.getXrmControlType=function(e,t,n){return a(this,void 0,void 0,(function(){var r,o;return c(this,(function(i){if(e){if(r=e.AttributeType,o=e.AttributeTypeName,["String","Memo","Customer","Owner","Uniqueidentifier"].includes(r))return[2,"Xrm.Controls.StringControl"];if(["DateTime"].includes(r))return[2,"Xrm.Controls.DateControl"];if(["Boolean","Picklist"].includes(r)||"MultiSelectPicklistType"===o.Value)return[2,"Xrm.Controls.OptionSetControl"];if(["Lookup"].includes(r))return[2,"Xrm.Controls.LookupControl"];if(["Integer","Double","BigInt","Decimal","Double","Money"].includes(r))return[2,"Xrm.Controls.NumberControl"]}return 4===t?[2,"Xrm.Controls.OptionSetControl"]:5===t?[2,"Xrm.Controls.GridControl"]:6===t?[2,"Xrm.Controls.FramedControl"]:(14===t||console.log(d.default.blue("".concat(this.entityLogicalName," control ").concat(n," type '").concat(t,"' falls back to Xrm.Controls.StandardControl."))),[2,"Xrm.Controls.StandardControl"])}))}))},e}();t.FormTypings=p},3563:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Generator=void 0;var c=a(n(3672)),s=i(n(8489)),u=n(2920),l=n(5713),f=n(6107),d=n(2779),p=n(438),h=n(6474),b=n(8389),y=function(){function e(){}return e.generate=function(e,t,n){if(s.test("-e","src"))if(e)if(["entity","webresource","model","licensevalidator","environmentvariable","globaloptionsets","customapis"].includes(e.toLowerCase())){if("entity"===e.toLowerCase())return d.EntityRouter.generateEntity(t,n);if("webresource"===e.toLowerCase())return u.Webresource.generateWebresource(t,n);if("model"===e.toLocaleLowerCase())return l.ModelRouter.generateModel(t,n);if("licensevalidator"===e.toLowerCase())return f.LicenseValidator.generateLicenseValidator(t);if("environmentvariable"===e.toLowerCase())return b.EnvironmentVariableRouter.generateEnvironmentVariable();if("globaloptionsets"===e.toLowerCase())return p.GlobalOptionSetRouter.generateGlobalOptionSets();if("customapis"===e.toLowerCase())return h.CustomApisRouter.generateCustomApis()}else console.log(c.default.red("Schematic ".concat(e," not supported!")));else console.log(c.default.red("No schematic specified!"));else console.log(c.default.red("You are not inside the project Webresources folder!"))},e.showGenerateHelp=function(){console.log("Arguments:"),console.log("   ".concat(c.default.blue("schematic"))),console.log("     The schematic or collection:schematic to generate."),console.log("     Example: Entity, Webresource or LicenseValidator.")},e}();t.Generator=y},7080:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalOptionSet=void 0;var u=i(n(8489)),l=n(9594),f=s(n(9896)),d=function(){function e(e){this.bearer=e}return e.prototype.generate=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return console.log("Generating Global OptionSet"),[4,this.writeGlobalOptionSetsFile()];case 1:return e.sent(),console.log("Generated Global OptionSet"),[2]}}))}))},e.prototype.writeGlobalOptionSetsFile=function(){return a(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:return console.log("Generating OptionSets/OptionSets.ts"),[4,this.getGlobalOptionSetsString()];case 1:return e=r.sent(),u.cp("-r","".concat(__dirname,"/OptionSets"),"src"),t="src/OptionSets/OptionSets.ts",n=String(f.default.readFileSync(t)),u.ShellString(n+e).to(t),u.exec("git add src/OptionSets"),console.log("Generated OptionSet/OptionSets.ts"),[2]}}))}))},e.prototype.getGlobalOptionSetsString=function(){return a(this,void 0,void 0,(function(){var t,n,r,o,i,a,s,u,f,d,p,h,b;return c(this,(function(c){switch(c.label){case 0:return t="",[4,l.NodeApi.getGlobalOptionSetDefinitions(this.bearer)];case 1:for(n=c.sent(),r=0,o=n;r<o.length;r++){if(i=o[r],a=e.capitalize(i.Name),t+="export enum ".concat(a," {\n"),"Boolean"===i.OptionSetType)s=i.FalseOption,u=i.TrueOption,t+="    ".concat(u.Label.UserLocalizedLabel.Label.replace(/\W/g,"")," = ").concat(u.Value,",\n"),t+="    ".concat(s.Label.UserLocalizedLabel.Label.replace(/\W/g,"")," = ").concat(s.Value,",\n");else for(f=[],d=0,p=i.Options;d<p.length;d++)h=p[d],b=h.Label.UserLocalizedLabel.Label.replace(/\W/g,""),f.includes(b)||(f.push(b),b.charAt(0).match(/^[a-zA-Z]/)||(b="Nr_".concat(b)),t+="    ".concat(b," = ").concat(h.Value,",\n"));t+="}\n"}return t&&(t+="\n"),[2,t]}}))}))},e.capitalize=function(e){return e.charAt(0).toUpperCase()+e.slice(1)},e}();t.GlobalOptionSet=d},6107:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.LicenseValidator=void 0;var u=s(n(3672)),l=i(n(8489)),f=s(n(9896)),d=s(n(6928)),p=s(n(5317)),h=function(){function e(){}return e.generateLicenseValidator=function(t){return a(this,void 0,void 0,(function(){var n;return c(this,(function(r){return n=f.default.existsSync(d.default.resolve(__dirname,"src/License/Validator/Validator.ts")),t?n?console.log(u.default.red("src/License already exist!")):process.argv[5]?console.log(u.default.red("No spaces allowed!")):e.generate(t):console.log(u.default.red("Module name missing")),[2]}))}))},e.generate=function(e){return a(this,void 0,void 0,(function(){var t,n,r,o;return c(this,(function(i){return console.log("Adding D365 License Validator for ".concat(e,"...")),t=JSON.parse(f.default.readFileSync("../crm.json","utf8")),n=t.crm,r=n.namespace,o=n.publisher_prefix,l.mkdir("src/License"),l.cp("-R","".concat(__dirname,"/License/*"),"./src/License"),l.ls("".concat(__dirname,"/License/Validator/*.*")).forEach((function(t){var n=t.split("/"),i=n[n.length-1];l.sed("-i",new RegExp("<%= licensename %>","ig"),e,"src/License/Validator/".concat(i)),l.sed("-i",new RegExp("<%= publisher %>","ig"),o,"src/License/Validator/".concat(i)),l.sed("-i",new RegExp("<%= namespace %>","ig"),r,"src/License/Validator/".concat(i))})),l.test("-e","../.git")&&p.default.execFileSync("git",["add","src/License"]),console.log("Adding D365 License Validator done"),[2]}))}))},e}();t.LicenseValidator=h},5187:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Model=void 0;var u=i(n(8489)),l=i(n(9896)),f=n(9594),d=s(n(9937)),p=s(n(3672)),h=s(n(5317)),b=function(){function e(e,t,n){this.bearer=e,this.entityName=t,this.entityLogicalName=n}return e.prototype.generate=function(){return a(this,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,this.generateModelFile()];case 1:return e.sent(),[2]}}))}))},e.prototype.generateModelFile=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i;return c(this,(function(a){switch(a.label){case 0:return e="src/".concat(this.entityName),u.test("-d",e)?[3,7]:this.entityLogicalName?[3,2]:[4,d.default.prompt([{type:"input",name:"entityLogicalName",message:"Entity LogicalName:"}])];case 1:t=a.sent(),this.entityLogicalName=t.entityLogicalName,a.label=2;case 2:return a.trys.push([2,4,,5]),[4,f.NodeApi.getEntityDefinition(this.entityLogicalName,this.bearer,["PrimaryIdAttribute"])];case 3:return a.sent(),[3,5];case 4:throw n=a.sent(),console.log(p.default.red("Failed: Entity ".concat(this.entityName," has no LogicalName ").concat(this.entityLogicalName))),n;case 5:return u.mkdir("src/".concat(this.entityName)),[4,this.addModelFile()];case 6:return a.sent(),[3,9];case 7:return r="src/".concat(this.entityName,"/").concat(this.entityName,".service.ts"),o=String(l.readFileSync(r)),i=o.match(new RegExp("static logicalName = '([a-zA-Z0-9_]*)';")),this.entityLogicalName=i[1],console.log(p.default.magenta("Entity ".concat(this.entityName," already exist"))),[4,this.addModelFile()];case 8:a.sent(),a.label=9;case 9:return console.log("Generating files finished"),[2]}}))}))},e.prototype.addModelFile=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,d,p,b,y;return c(this,(function(c){switch(c.label){case 0:return console.log("Generating ".concat(this.entityName,".model.ts")),e="src/".concat(this.entityName,"/").concat(this.entityName,".model.ts"),u.cp("-r","".concat(__dirname,"/Entity/Entity.model.ts"),"src/".concat(this.entityName)),u.cp("-r","src/".concat(this.entityName,"/Entity.model.ts"),e),u.rm("-rf","src/".concat(this.entityName,"/Entity.model.ts")),u.sed("-i",new RegExp("Entity","g"),this.entityName,e),u.test("-e","../.git")&&h.default.execFileSync("git",["add",e]),t=String(l.readFileSync(e)),n=this,[4,f.NodeApi.getAttributesMetadata(this.entityLogicalName,this.bearer)];case 1:return n.attributesMetadata=c.sent(),[4,this.getAttributeInterfaceTypes()];case 2:return r=c.sent(),[4,this.getRelationshipInterfaceTypes()];case 3:return o=c.sent(),[4,this.getImportStrings(o)];case 4:return i=c.sent(),[4,this.getTypeStrings()];case 5:return a=c.sent(),[4,this.getAttributesString(r,o)];case 6:return s=c.sent(),d=s,[4,this.getRelationshipsString(o,r)];case 7:return s=d+c.sent(),p=s,[4,this.getCombinedAttributeRelationshipString(r,o)];case 8:return s=p+c.sent(),b="".concat(this.entityName,"Model extends Model {"),t=t.replace(b,"".concat(b).concat(s)),y="interface",t=t.replace(y,"".concat(i).concat(a).concat(y)),u.ShellString(t).to(e),console.log("Generated ".concat(this.entityName,".model.ts")),[2]}}))}))},e.prototype.getImportStrings=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i,a,s,l;return c(this,(function(c){switch(c.label){case 0:n="",r=0,o=Object.keys(t),c.label=1;case 1:return r<o.length?(i=o[r],e.defaultModelAttributes.includes(i)?[3,3]:(a=t[i],[4,this.getDisplayName(a)])):[3,4];case 2:s=c.sent(),l="src/".concat(s,"/").concat(s,".model.ts"),u.test("-f",l)||(console.log(p.default.blue("NavigationProperty '".concat(i,"' generated"))),console.log(p.default.blue("Referenced model '".concat(s,"Model' not found."))),console.log(p.default.blue("Add referenced entity '".concat(s,"' by following cli command: "))+p.default.green("hso-d365 generate Entity ".concat(s))),console.log(p.default.blue("And regenerate '".concat(this.entityName,"' by following cli command: "))+p.default.green("hso-d365 generate Entity ".concat(this.entityName)))),c.label=3;case 3:return r++,[3,1];case 4:return[2,n]}}))}))},e.prototype.getCombinedAttributeRelationshipString=function(t,n){return a(this,void 0,void 0,(function(){var r,o,i,a,s,l,f,d,p,h;return c(this,(function(c){switch(c.label){case 0:r="",o=Object.keys(t),i=0,a=Object.keys(n),c.label=1;case 1:return i<a.length?(s=a[i],e.defaultModelAttributes.includes(s)||!o.includes(s)?[3,3]:(l=n[s],f=t[s],[4,this.getDisplayName(l)])):[3,4];case 2:d=c.sent(),p="src/".concat(d,"/").concat(d,".model.ts"),h=u.test("-f",p),r+="\n    ".concat(s,"?: ").concat(f),h||(r+="; // "),r+=" | ".concat(d,"Model;"),h||(r+=" // entity ".concat(d," needs to be generated")),r+="\n    '".concat(s,"@Microsoft.Dynamics.CRM.associatednavigationproperty'?: string;"),r+="\n    '".concat(s,"@Microsoft.Dynamics.CRM.lookuplogicalname'?: string;"),r+="\n    '".concat(s,"@OData.Community.Display.V1.FormattedValue'?: string;"),c.label=3;case 3:return i++,[3,1];case 4:return r&&(r="\n    // Attributes/NavigationProperties for $select and $expand"+r,r+="\n"),[2,r]}}))}))},e.prototype.getRelationshipsString=function(t,n){return a(this,void 0,void 0,(function(){var r,o,i,a,s,l,f,d,p;return c(this,(function(c){switch(c.label){case 0:r="\n    // NavigationProperties for $expand",o=Object.keys(n),i=0,a=Object.keys(t),c.label=1;case 1:return i<a.length?(s=a[i],e.defaultModelAttributes.includes(s)||o.includes(s)?[3,3]:(l=t[s],[4,this.getDisplayName(l)])):[3,4];case 2:f=c.sent(),d="src/".concat(f,"/").concat(f,".model.ts"),p=u.test("-f",d),r+="\n    ",p||(r+="// "),r+="".concat(s,"?: ").concat(f,"Model;"),p||(r+=" // entity ".concat(f," needs to be generated")),c.label=3;case 3:return i++,[3,1];case 4:return[2,r+="\n"]}}))}))},e.prototype.getRelationshipInterfaceTypes=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:return[4,f.NodeApi.getManyToOneMetadatas(this.entityLogicalName,this.bearer)];case 1:for(e=c.sent(),t={},n=0,r=e;n<r.length;n++)o=r[n],i=o.ReferencedEntity,a=o.ReferencingEntityNavigationPropertyName,t[a]=i;return[2,t]}}))}))},e.prototype.getAttributesString=function(t,n){return a(this,void 0,void 0,(function(){var r,o,i,a,s,u,l,d,p;return c(this,(function(c){switch(c.label){case 0:return[4,f.NodeApi.getEntityDefinition(this.entityLogicalName,this.bearer,["PrimaryIdAttribute","PrimaryNameAttribute"])];case 1:for(r=c.sent(),o=r.PrimaryIdAttribute,i=r.PrimaryNameAttribute,a=Object.keys(n),s="\n    // Attributes for $select\n",s+="    ".concat(o,"?: ").concat(t[o],"; // PrimaryIdAttribute\n"),s+="    ".concat(i,"?: ").concat(t[i],"; // PrimaryNameAttribute"),u=0,l=Object.keys(t);u<l.length;u++)d=l[u],p=t[d],e.defaultModelAttributes.includes(d)||d===o||d===i||a.includes(d)||(s+=this.getAttributeStrings(d,p));return[2,s+="\n"]}}))}))},e.prototype.getAttributeStrings=function(e,t){var n=this.attributesMetadata.find((function(t){return t.LogicalName===e})),r=n.AttributeType,o=n.AttributeTypeName,i="\n    ".concat(e,"?: ").concat(t,"; // ").concat(r);return["BigInt","Boolean","DateTime","Decimal","Double","Integer","Money","Picklist","State","Status"].includes(r)||"MultiSelectPicklistType"===o.Value?i+="\n    '".concat(e,"@OData.Community.Display.V1.FormattedValue'?: string;"):["Lookup","Customer","Owner"].includes(r)&&(i+="\n    '".concat(e,"@Microsoft.Dynamics.CRM.associatednavigationproperty'?: string;"),i+="\n    '".concat(e,"@Microsoft.Dynamics.CRM.lookuplogicalname'?: string;"),i+="\n    '".concat(e,"@OData.Community.Display.V1.FormattedValue'?: string;")),i},e.prototype.getAttributeInterfaceTypes=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a;return c(this,(function(c){switch(c.label){case 0:e={},t=0,n=this.attributesMetadata,c.label=1;case 1:return t<n.length?(r=n[t],o=r.AttributeType,i=r.LogicalName,[4,this.getInterfaceType(r)]):[3,4];case 2:(a=c.sent())?e[i]=a:console.log("To be implemented: ".concat(o," for ").concat(i)),c.label=3;case 3:return t++,[3,1];case 4:return[2,e]}}))}))},e.prototype.getInterfaceType=function(e){return a(this,void 0,void 0,(function(){var t,n,r;return c(this,(function(o){switch(o.label){case 0:return t=e.AttributeType,n=e.SchemaName,r=e.AttributeTypeName,["String","Memo","DateTime","Lookup","Customer","Owner","Uniqueidentifier"].includes(t)?[2,"string"]:[3,1];case 1:return["Boolean"].includes(t)?[2,"boolean"]:[3,2];case 2:return["Picklist"].includes(t)?[2,"".concat(this.entityName,"_").concat(n,"Values")]:[3,3];case 3:return["Integer","Double","BigInt","Decimal","Double","Money"].includes(t)?[2,"number"]:[3,4];case 4:return["Status"].includes(t)?[4,f.NodeApi.getStatusOptionSet(this.entityLogicalName,this.bearer)]:[3,6];case 5:return[2,o.sent().Options.map((function(e){return e.Value})).join(" | ")];case 6:return["State"].includes(t)?[4,f.NodeApi.getStateOptionSet(this.entityLogicalName,this.bearer)]:[3,8];case 7:return[2,o.sent().Options.map((function(e){return e.Value})).join(" | ")];case 8:if("MultiSelectPicklistType"===r.Value)return[2,"number[]"];o.label=9;case 9:return[2]}}))}))},e.prototype.getTypeStrings=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,o,i,a,s,u,l;return c(this,(function(c){switch(c.label){case 0:e="",t=0,n=this.attributesMetadata,c.label=1;case 1:return t<n.length?(r=n[t],o=r.AttributeType,i=r.LogicalName,a=r.SchemaName,s=r.AttributeTypeName,["Picklist","State","Status"].includes(o)||"MultiSelectPicklistType"===s.Value?(u=void 0,"Picklist"!==o?[3,3]:[4,f.NodeApi.getPicklistOptionSet(this.entityLogicalName,i,this.bearer)]):[3,10]):[3,11];case 2:return u=c.sent(),[3,9];case 3:return"State"!==o?[3,5]:[4,f.NodeApi.getStateOptionSet(this.entityLogicalName,this.bearer)];case 4:return u=c.sent(),[3,9];case 5:return"Status"!==o?[3,7]:[4,f.NodeApi.getStatusOptionSet(this.entityLogicalName,this.bearer)];case 6:return u=c.sent(),[3,9];case 7:return"MultiSelectPicklistType"!==(null==s?void 0:s.Value)?[3,9]:[4,f.NodeApi.getMultiSelectPicklistAttributeMetadata(this.entityLogicalName,i,this.bearer)];case 8:u=c.sent(),c.label=9;case 9:l=u.Options.map((function(e){return e.Value})).join(" | "),e+="type ".concat(this.entityName,"_").concat(a,"Values = ").concat(l||"never",";\n"),c.label=10;case 10:return t++,[3,1];case 11:return[2,e+="\n"]}}))}))},e.prototype.getDisplayName=function(e){return a(this,void 0,void 0,(function(){var t,n;return c(this,(function(r){switch(r.label){case 0:return[4,f.NodeApi.getEntityDefinition(e,this.bearer,["DisplayName"])];case 1:return t=r.sent().DisplayName,n=t.LocalizedLabels,[2,n.find((function(e){return 1033===e.LanguageCode})).Label.replace(/\W/g,"")]}}))}))},e.defaultModelAttributes=["createdonbehalfbyyominame","owneridname","importsequencenumber","modifiedbyyominame","utcconversiontimezonecode","createdbyyominame","modifiedbyname","timezoneruleversionnumber","owneridyominame","modifiedon","modifiedonbehalfbyyominame","createdbyname","createdon","createdonbehalfbyname","modifiedonbehalfbyname","versionnumber","overriddencreatedon","owningbusinessunit","owningteam","modifiedby","createdby","modifiedonbehalfby","owninguser","createdonbehalfby","statecode","statuscode","ownerid"],e}();t.Model=b},3060:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Regenerator=void 0;var a=i(n(9896)),c=n(2915),s=n(7080),u=n(935),l=n(2287),f=n(23),d=n(4409),p=function(){function e(e){this.bearer=e}return e.prototype.generate=function(){console.log("Regenerating. This may take some time..."),this.regenerateEntities().then(),this.regenerateGlobalOptionSets().then(),this.regenerateEnvironmentVariable().then(),console.log("Generated")},e.prototype.regenerateEntities=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,i,a;return o(this,(function(o){switch(o.label){case 0:return[4,this.getEntities()];case 1:for(e=o.sent(),t=0,n=e;t<n.length;t++)r=n[t],i=r.originallocalizedname||r.physicalname,a=i.replaceAll(/\W/g,""),new c.Entity(this.bearer,a,r.logicalname,{}).generate().then();return[2]}}))}))},e.prototype.getEntities=function(){return r(this,void 0,void 0,(function(){var e,t,n,r,i,c,s,u,p,h;return o(this,(function(o){switch(o.label){case 0:return e=JSON.parse(a.default.readFileSync("./crm.json","utf8")),t=e.crm.solution_name_generate,[4,l.SolutionService.getSolution(t,["solutionid"],this.bearer)];case 1:return n=o.sent(),r=[{type:"or",conditions:[{attribute:"msdyn_componenttype",value:1}]},{conditions:[{attribute:"msdyn_solutionid",value:n.solutionid}]}],[4,d.SolutionComponentSummaryService.retrieveMultipleRecords({select:["msdyn_objectid"],filters:r},this.bearer)];case 2:for(i=o.sent(),c=[],s=0,u=i;s<u.length;s++)p=u[s],h=p.msdyn_objectid,c.push({attribute:"entityid",value:h});return[2,f.EntityService.retrieveMultipleRecords({select:["entityid","collectionname","entitysetname","logicalname","name","objecttypecode","physicalname","originallocalizedname"],filters:[{type:"or",conditions:c}]},this.bearer)]}}))}))},e.prototype.regenerateGlobalOptionSets=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return console.log("hso-d365 generate GlobalOptionSets"),[4,new s.GlobalOptionSet(this.bearer).generate()];case 1:return e.sent(),[2]}}))}))},e.prototype.regenerateEnvironmentVariable=function(){return r(this,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return console.log("hso-d365 generate EnvironmentVariable"),[4,new u.EnvironmentVariable(this.bearer).generate()];case 1:return e.sent(),[2]}}))}))},e}();t.Regenerator=p},2920:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.Webresource=void 0;var u=s(n(3672)),l=i(n(8489)),f=s(n(9937)),d=i(n(9896)),p=s(n(5317)),h=function(){function e(){}return e.generateWebresource=function(t,n){var r=l.grep(" ".concat(t,":"),"webpack.config.ts");if(t)if(new RegExp("[A-Z]").test(t[0]))if("\n"!==r.stdout)console.log(u.default.red("Webresource ".concat(t," already exist!")));else if(process.argv[7])console.log(u.default.red("No spaces allowed!"));else{if(!n.template||["React","HTML"].includes(n.template))return e.generate(t,n);console.log(u.default.red("echo Webresource template must be 'React' or 'HTML'"))}else console.log(u.default.red("Webresource name must be UpperCamelCase!"));else console.log(u.default.red("Webresource name missing"))},e.generate=function(t,n){return a(this,void 0,void 0,(function(){var r,o,i;return c(this,(function(a){switch(a.label){case 0:return r="src/".concat(t),l.test("-d",r)?[3,5]:(console.log("Adding Webresource ".concat(t,"...")),(o=n.template)?[3,2]:[4,f.default.prompt([{type:"list",name:"template",message:"Which template do you want?",choices:["HTML","React"]}])]);case 1:i=a.sent(),o=i.template,a.label=2;case 2:return l.mkdir(r),[4,e.addWebresourceFiles(t,o)];case 3:return a.sent(),[4,e.addBuildFile(t,o)];case 4:return a.sent(),console.log("Added Webresource ".concat(t)),[3,6];case 5:console.log(u.default.magenta("Webresource ".concat(t," already exist"))),a.label=6;case 6:return[2]}}))}))},e.addWebresourceFiles=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o,i,a;return c(this,(function(c){return n=JSON.parse(d.readFileSync("../crm.json","utf8")),r=n.crm,o=r.namespace,i=r.publisher_prefix,a="".concat(__dirname,"/Webresource").concat("React"===t?"Tsx":"","/*.*"),l.ls(a).forEach((function(t){var n=t.split("/"),r=n[n.length-1],a=r.replace(/Webresource/g,e);l.cp("-r",t,"src/".concat(e)),l.cp("-r","src/".concat(e,"/").concat(r),"src/".concat(e,"/").concat(a)),l.rm("-rf","src/".concat(e,"/").concat(r)),l.sed("-i",new RegExp("Webresource","ig"),e,"src/".concat(e,"/").concat(a)),l.sed("-i",new RegExp("<%= publisher %>","ig"),i,"src/".concat(e,"/").concat(a)),l.sed("-i",new RegExp("<%= namespace %>","ig"),o,"src/".concat(e,"/").concat(a));var c="src/".concat(e,"/").concat(a);l.test("-e","../.git")&&p.default.execFileSync("git",["add",c])})),[2]}))}))},e.addBuildFile=function(e,t){return a(this,void 0,void 0,(function(){var n,r,o;return c(this,(function(i){return console.log("Adding ".concat(e,"/build.json")),n="src/".concat(e,"/build.json"),l.cp("-r","".concat(__dirname,"/Entity/build.json"),n),r=String(d.readFileSync(n)),(o=JSON.parse(r)).webresources.find((function(t){return t.name===e}))||(o.webresources.push({name:e,build:!0,template:t}),l.ShellString(JSON.stringify(o,null,2)).to(n)),l.test("-e","../.git")&&p.default.execFileSync("git",["add",n]),console.log("Added ".concat(e,"/build.json")),[2]}))}))},e}();t.Webresource=h},7670:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0});var a=i(n(8489)),c=n(6858),s=n(9051),u=n(8070),l=n(3563),f=n(9836),d=n(2017),p=n(5141),h=i(n(8330)),b=n(9530),y=i(n(9896)),m=i(n(3672)),g=n(4789),v=new c.Command,w=function(){if(!a.default.test("-e","src"))return console.log(m.default.red("You are not inside the project Webresources folder!")),!1;var e=a.default.exec("hso-d365 --version").stdout.replace(/\n/gi,""),t=JSON.parse(y.default.readFileSync("../crm.json","utf8"));return e===t.version||(console.log(m.default.red("Version mismatch!")),console.log("CLI version: ".concat(m.default.red(e))),console.log("Project version: ".concat(m.default.red(t.version))),console.log("Please update project (hso-d365 update) or CLI (npm i -g @hso/d365-cli@".concat(t.version,") first.")),!1)};v.version(h.default.version).usage("<command> [options]"),v.command("new <name>").alias("n").option("--environment","Environment").option("--solution_deploy","Deploy Solution").option("--solution_generate","Generate Solution").option("--publisher_name","Publisher name").option("--publisher_prefix","Publisher prefix").option("--namespace","Namespace").description("Creates a new workspace and an initial Webresource").action((function(e,t){s.Create.createProject(e,t)})).on("--help",(function(){s.Create.showCreateHelp()})),v.command("regenerate").alias("rg").description("Regenerates files").action((function(){return r(void 0,void 0,void 0,(function(){return o(this,(function(e){switch(e.label){case 0:return w()?[4,b.RegeneratorRouter.regenerate()]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}}))}))})).on("--help",(function(){console.log("Regenerates files")})),v.command("generate <schematic> [name]").alias("g").option("-s, --skipForms","Skip generating form files").option("-logicalName, --entityLogicalName <entityLogicalName>","LogicalName of the Entity").option("-t, --template <template>","Template of Webresource").description("Generates and/or modifies files bases on a schematic.").action((function(e,t,n){w()&&l.Generator.generate(e,t,n)})).on("--help",(function(){l.Generator.showGenerateHelp()})),v.command("extractTranslations").alias("extract").description("Extracts translation to resx files").action((function(){d.Resx.extract()})).on("--help",(function(){console.log("In translation folder a folder 'locales' will be generated having translation files."),console.log("It will generate one locales.resx file."),console.log("You have to add for each required language a copy yourself like locales.1033.resx."),console.log("Once done, the tooling will keep up-to-date for you.")})),v.command("lint").alias("l").description("Runs linting tools on project code").action((function(){a.default.exec("npm run lint")})).on("--help",(function(){console.log("Runs linting tools on project code using the configuration as specified in your projects '.eslintrc.json' file")})),v.command("build").alias("b").description("Compiles project into an output directory named dist").action((function(){a.default.exec("npm run build:prod")})).on("--help",(function(){console.log("The command can be used to build the project to be distributed to the D365 environment using the 'deploy' command")})),v.command("deploy").option("-f, --force","Force unmodified files as well").description("Invokes the deploy builder").action((function(e){var t=e.force;f.Deploy.deployProject(t)})).on("--help",(function(){console.log("Distributes the project to the D365 environment. You need to run the 'build' command first")})),v.command("update").alias("u").description("Updates existing workspace and Webresource setup").action((function(){(function(){if(!a.default.test("-e","src"))return console.log(m.default.red("You are not inside the project Webresources folder!")),!1;var e=a.default.exec("hso-d365 --version").stdout.replace(/\n/gi,""),t=JSON.parse(y.default.readFileSync("../crm.json","utf8"));if(t)for(var n=e.split("."),r=t.version.split("."),o=0;o<3;o+=1){if(n[o]>r[o])return!0;if(n[o]<r[o])return console.log(m.default.red("Version mismatch! You try to do a downgrade!")),console.log("CLI version: ".concat(m.default.red(e))),console.log("Project version: ".concat(m.default.red(t.version))),console.log("Please update CLI (npm i -g @hso/d365-cli@".concat(t.version,") first.")),!1}return!0})()&&u.Update.updateProject()})).on("--help",(function(){u.Update.showUpdateHelp()})),v.command("setFormCustomizable <customizable>").alias("f").description("Sets the Solution forms iscustomizable/canbedeleted true/false").action((function(e){new p.SetFormCustomizable("true"===e)})).on("--help",(function(){console.log("Sets the Solution forms iscustomizable/canbedeleted true/false")})),v.command("setOnloads").description("Set the Onload events for the forms").action((function(){new g.SetOnloads})).on("--help",(function(){console.log("Set the Onload events for the forms")})),v.command("showFiddlerRule").alias("fiddler").description("Show the Fiddler AutoResponder Rule Editor lines").action((function(){return r(void 0,void 0,void 0,(function(){var e,t,n,r;return o(this,(function(o){return e=process.cwd(),t=JSON.parse(y.default.readFileSync("../crm.json","utf8")),n="REGEX:(?insx).+\\/".concat(t.crm.publisher_prefix,"_\\/").concat(t.crm.namespace,"\\/(?'foldername'[^?]*)\\/(?'fname'[^?]*.js)"),r="".concat(e,"\\dist\\").concat(t.crm.publisher_prefix,"_\\").concat(t.crm.namespace,"\\${foldername}\\${fname}"),console.log("Please add to first Rule Editor line (including REGEX:): \n".concat(n)),console.log("Please add to second Rule Editor line: \n".concat(r)),[2]}))}))})),v.arguments("<command>").action((function(){v.outputHelp(),console.log(""),console.log("echo Unknown command!")})),v.parse(process.argv)},1251:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomApiRequestParameterService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.entitySetName="customapirequestparameters",e}();t.CustomApiRequestParameterService=a},3919:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomApiResponsePropertyService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.entitySetName="customapiresponseproperties",e}();t.CustomApiResponsePropertyService=a},3267:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomApiService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.entitySetName="customapis",e}();t.CustomApiService=a},23:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.EntityService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.entitySetName="entities",e}();t.EntityService=a},1547:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentVariableDefinitionService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.entitySetName="environmentvariabledefinitions",e}();t.EnvironmentVariableDefinitionService=a},9594:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.NodeApi=void 0;var s=i(n(9896)),u=i(n(5692)),l=function(){function e(){}return e.getSettings=function(){return e.cachedSettings||(e.cachedSettings=JSON.parse(s.readFileSync("../crm.json","utf8"))),e.cachedSettings},e.fetchXml=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s,u;return c(this,(function(c){switch(c.label){case 0:return o=e.getSettings().crm,i=o.url,a=o.version,s="".concat(i,"/api/data/v").concat(a,"/").concat(t,"?fetchXml=").concat(encodeURIComponent(n)),[4,e.request("GET",s,null,{Authorization:"Bearer ".concat(r)})];case 1:return u=c.sent(),console.log("URI: ".concat(s)),[2,u]}}))}))},e.retrieveMultipleRecords=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s,u;return c(this,(function(c){switch(c.label){case 0:return o=e.getSystemQueryOptions(n),i=e.getSettings().crm,a=i.url,s=i.version,u="".concat(a,"/api/data/v").concat(s,"/").concat(t).concat(o),[4,e.request("GET",u,null,{Authorization:"Bearer ".concat(r)})];case 1:return[2,c.sent().body.value]}}))}))},e.retrieveRecord=function(t,n,r,o){return a(this,void 0,void 0,(function(){var i,a,s,u,l;return c(this,(function(c){switch(c.label){case 0:return i=e.getSystemQueryOptions(r),a=e.getSettings().crm,s=a.url,u=a.version,l="".concat(s,"/api/data/v").concat(u,"/").concat(t,"(").concat(n,")").concat(i),[4,e.request("GET",l,null,{Authorization:"Bearer ".concat(o)})];case 1:return[2,c.sent().body]}}))}))},e.updateRecord=function(t,n,r,o){return a(this,void 0,void 0,(function(){var i,a,s,u;return c(this,(function(c){switch(c.label){case 0:return i=e.getSettings().crm,a=i.url,s=i.version,u="".concat(a,"/api/data/v").concat(s,"/").concat(t,"(").concat(n,")"),[4,e.request("PATCH",u,r,{Authorization:"Bearer ".concat(o),Prefer:"return=representation"})];case 1:return[2,c.sent().body]}}))}))},e.insertRecord=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return o=e.getSettings().crm,i=o.url,a=o.version,s="".concat(i,"/api/data/v").concat(a,"/").concat(t),[4,e.request("POST",s,n,{Authorization:"Bearer ".concat(r),Prefer:"return=representation"})];case 1:return[2,c.sent().body]}}))}))},e.getStatusOptionSet=function(t,n){return a(this,void 0,void 0,(function(){var r,o,i,a;return c(this,(function(c){switch(c.label){case 0:return r=e.getSettings().crm,o=r.url,i=r.version,a="".concat(o,"/api/data/v").concat(i,"/EntityDefinitions(LogicalName='").concat(t,"')/Attributes/Microsoft.Dynamics.CRM.StatusAttributeMetadata?$expand=OptionSet"),[4,e.request("GET",a,null,{Authorization:"Bearer ".concat(n)})];case 1:return[2,c.sent().body.value[0].OptionSet]}}))}))},e.getStateOptionSet=function(t,n){return a(this,void 0,void 0,(function(){var r,o,i,a;return c(this,(function(c){switch(c.label){case 0:return r=e.getSettings().crm,o=r.url,i=r.version,a="".concat(o,"/api/data/v").concat(i,"/EntityDefinitions(LogicalName='").concat(t,"')/Attributes/Microsoft.Dynamics.CRM.StateAttributeMetadata?$expand=OptionSet"),[4,e.request("GET",a,null,{Authorization:"Bearer ".concat(n)})];case 1:return[2,c.sent().body.value[0].OptionSet]}}))}))},e.getMultiSelectPicklistAttributeMetadata=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return o=e.getSettings().crm,i=o.url,a=o.version,s="".concat(i,"/api/data/v").concat(a,"/EntityDefinitions(LogicalName='").concat(t,"')/Attributes(LogicalName='").concat(n,"')/Microsoft.Dynamics.CRM.MultiSelectPicklistAttributeMetadata?$select=LogicalName&$expand=OptionSet($select=Options,IsGlobal)"),[4,e.request("GET",s,null,{Authorization:"Bearer ".concat(r)})];case 1:return[2,c.sent().body.OptionSet]}}))}))},e.getPicklistOptionSet=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return o=e.getSettings().crm,i=o.url,a=o.version,s="".concat(i,"/api/data/v").concat(a,"/EntityDefinitions(LogicalName='").concat(t,"')/Attributes(LogicalName='").concat(n,"')/Microsoft.Dynamics.CRM.PicklistAttributeMetadata?$select=LogicalName&$expand=OptionSet($select=Options,IsGlobal)"),[4,e.request("GET",s,null,{Authorization:"Bearer ".concat(r)})];case 1:return[2,c.sent().body.OptionSet]}}))}))},e.getGlobalOptionSetDefinitions=function(t){return a(this,void 0,void 0,(function(){var n,r,o,i;return c(this,(function(a){switch(a.label){case 0:return n=e.getSettings().crm,r=n.url,o=n.version,i="".concat(r,"/api/data/v").concat(o,"/GlobalOptionSetDefinitions"),[4,e.request("GET",i,null,{Authorization:"Bearer ".concat(t)})];case 1:return[2,a.sent().body.value]}}))}))},e.getBooleanOptionSet=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return o=e.getSettings().crm,i=o.url,a=o.version,s="".concat(i,"/api/data/v").concat(a,"/EntityDefinitions(LogicalName='").concat(t,"')/Attributes(LogicalName='").concat(n,"')/Microsoft.Dynamics.CRM.BooleanAttributeMetadata?$select=LogicalName&$expand=OptionSet($select=TrueOption,FalseOption,IsGlobal)"),[4,e.request("GET",s,null,{Authorization:"Bearer ".concat(r)})];case 1:return[2,c.sent().body.OptionSet]}}))}))},e.executeAction=function(e,t,n,r,o){return a(this,void 0,void 0,(function(){return c(this,(function(i){return r?[2,this.executeBoundAction(e,t,n,r,o)]:[2,this.executeUnboundAction(e,t,n)]}))}))},e.executeBoundAction=function(t,n,r,o,i){return a(this,void 0,void 0,(function(){var a,s,u,l,f;return c(this,(function(c){switch(c.label){case 0:return[4,Xrm.Utility.getEntityMetadata(o)];case 1:return a=c.sent(),s=e.getSettings().crm,u=s.url,l=s.version,f="".concat(u,"/api/data/v").concat(l,"/").concat(a.EntitySetName,"(").concat(i,")/Microsoft.Dynamics.CRM.").concat(t),[4,e.request("POST",f,r,{Authorization:"Bearer ".concat(n)})];case 2:return[2,c.sent().body]}}))}))},e.executeUnboundAction=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s,u;return c(this,(function(c){switch(c.label){case 0:return o=r?"POST":"GET",i=e.getSettings().crm,a=i.url,s=i.version,u="".concat(a,"/api/data/v").concat(s,"/").concat(t),[4,e.request(o,u,r,{Authorization:"Bearer ".concat(n)})];case 1:return[2,c.sent().body]}}))}))},e.getSystemQueryOptions=function(t){var n=t.select,r=t.filters,o=t.top,i=e.generateSelect(n),a=e.generateFilter(r),c=o?"$top=".concat(o):null,s=[];return i&&s.push(i),a&&s.push(a),c&&s.push(c),s.length>0?"?".concat(s.join("&")):""},e.generateSelect=function(e){return void 0===e&&(e=[]),e.length>0?"$select=".concat(e.join(",")):null},e.generateFilter=function(t){void 0===t&&(t=[]);var n=[];if(t.length>0)for(var r=0,o=t;r<o.length;r++){var i=o[r];n.push(e.parseFilter(i))}return n.length>0?"$filter=".concat(n.join(" and ")):null},e.parseFilter=function(e){for(var t=e.type,n=void 0===t?"and":t,r=[],o=0,i=e.conditions;o<i.length;o++){var a=i[o],c=a.attribute,s=a.operator,u=void 0===s?"eq":s,l=a.value,f="".concat(c," ").concat(u);f+="string"==typeof l?" '".concat(l,"'"):" ".concat(l),r.push(f)}return"(".concat(r.join(" ".concat(n," ")),")")},e.request=function(t,n,r,o){return void 0===o&&(o={}),new Promise((function(i,a){var c=e.getRequestOptions(t,n,o,r),s=u.request(c,(function(t){var n="";t.setEncoding("utf8"),t.on("data",(function(e){return n+=e})),t.on("end",(function(){try{i(e.handleNodeHttpsResponse(t,n))}catch(e){a(e)}}))}));s.on("error",(function(e){a(e)})),"GET"!==t&&s.write(r&&JSON.stringify(r)),s.end()}))},e.getRequestOptions=function(t,n,r,o){var i=n.split("/"),a=i[2],c="/"+i.slice(3,i.length).join("/"),s=Object.assign({},e.jsonHeaders,r);if("GET"!==t){var u=o&&JSON.stringify(o);s["Content-Length"]=u.length}return{hostname:a,port:443,path:encodeURI(c),method:t,headers:s}},e.handleNodeHttpsResponse=function(t,n){var r={200:function(){return e.dataHandler(t,n)},201:function(){return e.dataHandler(t,n)},204:function(){return{body:"",getResponseHeader:function(e){return t.headers[e]},statusCode:t.statusCode}}}[t.statusCode];if(r)return r();if(401===t.statusCode)throw new Error("Unauthorized");throw new Error("".concat(t.statusCode,": ").concat(t.statusMessage,"\n ").concat(n))},e.dataHandler=function(e,t){var n=null;try{n=JSON.parse(t)}catch(e){throw new Error("JSON response can't be parsed")}return{body:n,getResponseHeader:function(t){return e.headers[t]},statusCode:e.statusCode}},e.getEntityDefinition=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return o=e.getSettings().crm,i=o.url,a=o.version,s="".concat(i,"/api/data/v").concat(a,"/EntityDefinitions(LogicalName='").concat(t,"')"),r&&(s+="?$select=".concat(r.join(","))),[4,e.request("GET",s,null,{Authorization:"Bearer ".concat(n)})];case 1:return[2,c.sent().body]}}))}))},e.getManyToOneMetadatas=function(t,n){return a(this,void 0,void 0,(function(){var r,o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return r=e.getSettings().crm,o=r.url,i=r.version,a="".concat(o,"/api/data/v").concat(i,"/EntityDefinitions(LogicalName='").concat(t,"')/ManyToOneRelationships"),[4,e.request("GET",a,null,{Authorization:"Bearer ".concat(n)})];case 1:return s=c.sent().body,[2,s.value]}}))}))},e.getAttributesMetadata=function(t,n,r){return a(this,void 0,void 0,(function(){var o,i,a,s,u;return c(this,(function(c){switch(c.label){case 0:return o=e.getSettings().crm,i=o.url,a=o.version,s="".concat(i,"/api/data/v").concat(a,"/EntityDefinitions(LogicalName='").concat(t,"')/Attributes?$filter=IsValidODataAttribute eq true"),r&&(s+="&$select=".concat(r.join(","))),[4,e.request("GET",s,null,{Authorization:"Bearer ".concat(n)})];case 1:return u=c.sent().body,[2,u.value]}}))}))},e.jsonHeaders={"OData-MaxVersion":"4.0","OData-Version":"4.0",Accept:"application/json","Content-Type":"application/json; charset=utf-8"},e}();t.NodeApi=l},1071:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.PublisherService=void 0;var a=n(9594),c=n(2287),s=i(n(9896)),u=function(){function e(){}return e.retrieveRecord=function(t,n,i){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,a.NodeApi.retrieveRecord(e.entitySetName,t,n,i)]}))}))},e.getPublisher=function(t){return r(this,void 0,void 0,(function(){var n,r,i;return o(this,(function(o){switch(o.label){case 0:return n=JSON.parse(s.default.readFileSync("./crm.json","utf8")),r=n.crm.solution_name_deploy,[4,c.SolutionService.getSolution(r,["_publisherid_value"],t)];case 1:return i=o.sent(),[2,e.retrieveRecord(i._publisherid_value,{select:["publisherid","customizationprefix"]},t)]}}))}))},e.entitySetName="publishers",e}();t.PublisherService=u},3991:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SavedQueryService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.updateRecord=function(t,n,a){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.updateRecord(e.entitySetName,t,n,a)]}))}))},e.entitySetName="savedqueries",e}();t.SavedQueryService=a},4409:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.SolutionComponentSummaryService=void 0;var a=n(9594),c=i(n(9896)),s=n(2287),u=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,a.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.retrieveFormSolutionComponentSummaries=function(e){return r(this,void 0,void 0,(function(){var t,n,r,i,a,u,l,f,d;return o(this,(function(o){switch(o.label){case 0:return t=[],n=JSON.parse(c.default.readFileSync("./crm.json","utf8")),r=n.crm.solution_name_deploy,console.log("Solution name: ".concat(r)),[4,s.SolutionService.getSolution(r,["solutionid"],e)];case 1:return i=o.sent(),console.log("Solution id: ".concat(i.solutionid)),[4,this.retrieveEntitySolutionComponentSummaries(i,e)];case 2:a=o.sent(),u=0,l=a,o.label=3;case 3:return u<l.length?(f=l[u],[4,this.retrieveFormsSolutionComponentSummaries(i,e,f)]):[3,6];case 4:d=o.sent(),t.push.apply(t,d),o.label=5;case 5:return u++,[3,3];case 6:return[2,t]}}))}))},e.retrieveEntitySolutionComponentSummaries=function(t,n){return r(this,void 0,void 0,(function(){var r;return o(this,(function(o){return r=[{conditions:[{attribute:"msdyn_solutionid",value:t.solutionid},{attribute:"msdyn_componenttype",value:1}]}],[2,e.retrieveMultipleRecords({select:["msdyn_objectid","msdyn_name","msdyn_schemaname","msdyn_displayname"],filters:r},n)]}))}))},e.retrieveFormsSolutionComponentSummaries=function(t,n,i){return r(this,void 0,void 0,(function(){var r,a,c,s;return o(this,(function(o){switch(o.label){case 0:return r=[{conditions:[{attribute:"msdyn_solutionid",value:t.solutionid},{attribute:"msdyn_componenttype",value:60},{attribute:"msdyn_primaryentityname",value:i.msdyn_schemaname}]}],[4,e.retrieveMultipleRecords({select:["msdyn_objectid","msdyn_name"],filters:r},n)];case 1:for(a=o.sent(),c=0,s=a;c<s.length;c++)s[c].msdyn_displayname=i.msdyn_displayname;return[2,a]}}))}))},e.entitySetName="msdyn_solutioncomponentsummaries",e}();t.SolutionComponentSummaryService=u},2287:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SolutionService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.getSolution=function(t,n,i){return r(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,e.retrieveMultipleRecords({select:n,filters:[{conditions:[{attribute:"uniquename",value:t}]}]},i)];case 1:return[2,r.sent()[0]]}}))}))},e.entitySetName="solutions",e}();t.SolutionService=a},4935:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.SystemFormService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.updateRecord=function(t,n,a){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.updateRecord(e.entitySetName,t,n,a)]}))}))},e.getSystemForm=function(t,n,i){return r(this,void 0,void 0,(function(){return o(this,(function(r){switch(r.label){case 0:return[4,e.retrieveMultipleRecords({select:n,filters:[{conditions:[{attribute:"formid",value:t}]}]},i)];case 1:return[2,r.sent()[0]]}}))}))},e.entitySetName="systemforms",e}();t.SystemFormService=a},5127:function(e,t,n){var r=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},o=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.WebresourceService=void 0;var i=n(9594),a=function(){function e(){}return e.retrieveMultipleRecords=function(t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveMultipleRecords(e.entitySetName,t,n)]}))}))},e.retrieveRecord=function(t,n,a){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.retrieveRecord(e.entitySetName,t,n,a)]}))}))},e.upsert=function(t,n){return r(this,void 0,void 0,(function(){var r,a,c;return o(this,(function(o){switch(o.label){case 0:return t.webresourceid?[4,i.NodeApi.updateRecord(e.entitySetName,t.webresourceid,t,n)]:[3,2];case 1:return o.sent(),[2,t];case 2:return r=t.name.split("."),a=r[r.length-1],c=t,[4,e.getWebresourcetype(a,n)];case 3:return c.webresourcetype=o.sent(),[4,i.NodeApi.insertRecord(e.entitySetName,t,n)];case 4:return[2,o.sent()]}}))}))},e.publish=function(e,t){return r(this,void 0,void 0,(function(){var n;return o(this,(function(r){return n={ParameterXml:"<importexportxml><webresources><webresource>{".concat(e.webresourceid,"}</webresource></webresources></importexportxml>")},[2,i.NodeApi.executeAction("PublishXml",t,n)]}))}))},e.addToSolution=function(e,t,n){return r(this,void 0,void 0,(function(){return o(this,(function(r){return[2,i.NodeApi.executeAction("AddSolutionComponent",n,{ComponentId:e.webresourceid,ComponentType:61,SolutionUniqueName:t,AddRequiredComponents:!1,IncludedComponentSettingsValues:null})]}))}))},e.getWebresourcetype=function(t,n){return r(this,void 0,void 0,(function(){var r,a,c,s,u,l,f,d;return o(this,(function(o){switch(o.label){case 0:return[4,i.NodeApi.getPicklistOptionSet(e.logicalName,"webresourcetype",n)];case 1:for(r=o.sent(),s=0,u=r.Options;s<u.length;s++)if(l=u[s],f=l.Value,(d=l.Label.UserLocalizedLabel.Label).toLocaleLowerCase().includes("script")&&(c=parseInt(String(f),10)),d.toLowerCase().includes(t)){a=parseInt(String(f),10);break}return a||"json"!==t||(a=c),[2,a]}}))}))},e.logicalName="webresource",e.entitySetName="webresourceset",e}();t.WebresourceService=a},6474:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.CustomApisRouter=void 0;var c=n(7301),s=n(3474),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateCustomApis=function(){return new t,null},t.prototype.onAuthenticated=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,new s.CustomApis(this.bearer).generate()];case 1:return e.sent(),[2]}}))}))},t}(c.MsalRouter);t.CustomApisRouter=u},2779:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.EntityRouter=void 0;var s=c(n(3672)),u=n(7301),l=n(2915),f=function(e){function t(t,n){var r=e.call(this)||this;return r.entityName=t,r.entityLogicalName=n.entityLogicalName,r.options=n,r}return o(t,e),t.generateEntity=function(e,n){return i(this,void 0,void 0,(function(){return a(this,(function(r){return e?new RegExp("[A-Z]").test(e[0])?new t(e,n):console.log(s.default.red("Entity name must be UpperCamelCase!")):console.log(s.default.red("Entity name missing")),[2,null]}))}))},t.prototype.onAuthenticated=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,new l.Entity(this.bearer,this.entityName,this.entityLogicalName,this.options).generate()];case 1:return e.sent(),[2]}}))}))},t}(u.MsalRouter);t.EntityRouter=f},8389:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.EnvironmentVariableRouter=void 0;var c=n(7301),s=n(935),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateEnvironmentVariable=function(){return new t,null},t.prototype.onAuthenticated=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,new s.EnvironmentVariable(this.bearer).generate()];case 1:return e.sent(),[2]}}))}))},t}(c.MsalRouter);t.EnvironmentVariableRouter=u},438:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.GlobalOptionSetRouter=void 0;var c=n(7301),s=n(7080),u=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.generateGlobalOptionSets=function(){return new t,null},t.prototype.onAuthenticated=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,new s.GlobalOptionSet(this.bearer).generate()];case 1:return e.sent(),[2]}}))}))},t}(c.MsalRouter);t.GlobalOptionSetRouter=u},5713:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},c=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.ModelRouter=void 0;var s=n(7301),u=c(n(3672)),l=n(5187),f=function(e){function t(t,n){var r=e.call(this)||this;return r.entityName=t,r.entityLogicalName=n.entityLogicalName,r}return o(t,e),t.generateModel=function(e,n){return i(this,void 0,void 0,(function(){return a(this,(function(r){return e?new RegExp("[A-Z]").test(e[0])?process.argv[5]?console.log(u.default.red("No spaces allowed!")):new t(e,n):console.log(u.default.red("Entity name must be UpperCamelCase!")):console.log(u.default.red("Entity name missing")),[2,null]}))}))},t.prototype.onAuthenticated=function(){return i(this,void 0,void 0,(function(){return a(this,(function(e){switch(e.label){case 0:return[4,new l.Model(this.bearer,this.entityName,this.entityLogicalName).generate()];case 1:return e.sent(),[2]}}))}))},t}(s.MsalRouter);t.ModelRouter=f},7301:function(e,t,n){var r=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),o=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),i=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&r(t,e,n);return o(t,e),t},a=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},c=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},s=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.MsalRouter=void 0;var u=s(n(7252)),l=s(n(2080)),f=s(n(5977)),d=i(n(9896)),p=n(5672),h=s(n(8489)),b=function(){function e(){this.sockets=[],this.settings=JSON.parse(d.readFileSync("../crm.json","utf8")),this.init().then()}return e.prototype.init=function(){return a(this,void 0,void 0,(function(){var e;return c(this,(function(t){switch(t.label){case 0:return this.pca=this.initPublicClientApplication(),e=this,[4,this.getCachedToken()];case 1:return e.bearer=t.sent(),this.bearer?[4,this.onAuthenticated()]:[3,3];case 2:return t.sent(),[3,4];case 3:this.acquireToken(),t.label=4;case 4:return[2]}}))}))},e.prototype.getCachedToken=function(){return a(this,void 0,void 0,(function(){var e,t,n;return c(this,(function(r){switch(r.label){case 0:return(e=this.pca.getTokenCache()).hasChanged()?[3,5]:[4,e.getAllAccounts()];case 1:if(1!==(t=r.sent()).length)return[3,5];r.label=2;case 2:return r.trys.push([2,4,,5]),[4,this.pca.acquireTokenSilent({account:t[0],scopes:["".concat(this.settings.crm.url,"/.default")]})];case 3:return[2,r.sent().accessToken];case 4:return n=r.sent(),console.log(n.message),[3,5];case 5:return[2]}}))}))},e.prototype.initPublicClientApplication=function(){var t=this.settings.msal.tenant?this.settings.msal.tenant:"common/",n={auth:{clientId:this.settings.msal.clientId,authority:"https://login.microsoftonline.com/"+t},cache:{cachePlugin:e.getCachePlugin()},system:{loggerOptions:{loggerCallback:function(e,t,n){n&&console.log(n),console.log(t)},piiLoggingEnabled:!1,logLevel:p.LogLevel.Verbose}}};return new p.PublicClientApplication(n)},e.getCachePlugin=function(){var e=this;d.existsSync("./.msalcache.json")||h.default.cp("-R","".concat(__dirname,"/root/Webresources/.msalcache.json"),".");var t="./.msalcache.json";return{beforeCacheAccess:function(n){return a(e,void 0,void 0,(function(){return c(this,(function(e){return n.tokenCache.deserialize(d.readFileSync(t,"utf-8")),[2]}))}))},afterCacheAccess:function(n){return a(e,void 0,void 0,(function(){return c(this,(function(e){return n.cacheHasChanged&&d.writeFileSync(t,n.tokenCache.serialize()),[2]}))}))}}},e.prototype.acquireToken=function(){this.express=(0,u.default)();var e=this.settings.crm,t=e.publisher_prefix,n=e.namespace,r={secret:"".concat(t).concat(n),resave:!1,saveUninitialized:!1,cookie:{httpOnly:!0},name:"id"};"production"===this.express.get("env")&&(this.express.set("trust proxy",1),r.cookie.secure=!0),this.express.set("trust proxy",1),this.express.use((0,f.default)(r)),this.mountRoutes(),this.startListen()},e.prototype.startListen=function(){var e=this,t=this.settings.msal.redirectUri.split("/"),n=t[t.length-2].split(":"),r=parseInt(n[1]),o=t.slice(0,t.length-1).join("/");this.httpServer=this.express.listen(r,(function(){return a(e,void 0,void 0,(function(){return c(this,(function(e){switch(e.label){case 0:return[4,(0,l.default)(o)];case 1:return e.sent(),[2,console.log("server is listening on ".concat(r))]}}))}))})),this.httpServer.on("connection",(function(t){e.sockets.push(t)}))},e.prototype.mountRoutes=function(){this.mountDefaultRoute(),this.mountRedirectRoute()},e.prototype.mountDefaultRoute=function(){var e=this;this.express.get("/",(function(t,n){return a(e,void 0,void 0,(function(){var e,r,o,i,a,s;return c(this,(function(c){switch(c.label){case 0:return[4,(new p.CryptoProvider).generatePkceCodes()];case 1:e=c.sent(),r=e.verifier,o=e.challenge,t.session.pkceCodes||(t.session.pkceCodes={challengeMethod:"S256"}),t.session.pkceCodes.verifier=r,t.session.pkceCodes.challenge=o,i={redirectUri:this.settings.msal.redirectUri,scopes:["".concat(this.settings.crm.url,"/.default")],codeChallenge:t.session.pkceCodes.challenge,codeChallengeMethod:t.session.pkceCodes.challengeMethod},c.label=2;case 2:return c.trys.push([2,4,,5]),[4,this.pca.getAuthCodeUrl(i)];case 3:return a=c.sent(),n.redirect(a),[3,5];case 4:return s=c.sent(),console.log(JSON.stringify(s)),[3,5];case 5:return[2]}}))}))}))},e.prototype.mountRedirectRoute=function(){var e=this;this.express.get("/msal",(function(t,n){return a(e,void 0,void 0,(function(){var e,r,o,i=this;return c(this,(function(a){switch(a.label){case 0:if(!t||!n)return[3,4];e={code:t.query.code,scopes:["".concat(this.settings.crm.url,"/.default")],redirectUri:this.settings.msal.redirectUri,codeVerifier:t.session.pkceCodes.verifier,clientInfo:t.query.client_info},a.label=1;case 1:return a.trys.push([1,3,,4]),[4,this.pca.acquireTokenByCode(e)];case 2:return r=a.sent(),this.bearer=r.accessToken,n.send("You can close this window"),setTimeout((function(){i.httpServer.close((function(){return console.log("server stopped listening")}));for(var e=0,t=i.sockets;e<t.length;e++){t[e].destroy()}i.onAuthenticated()}),100),[3,4];case 3:return o=a.sent(),console.log(o),n.status(500).send("Error occurred. Check console for more info \n You can close this window"),[3,4];case 4:return[2]}}))}))}))},e.prototype.onAuthenticated=function(){return Promise.resolve()},e}();t.MsalRouter=b},9530:function(e,t,n){var r,o=this&&this.__extends||(r=function(e,t){return r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},r(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}),i=this&&this.__createBinding||(Object.create?function(e,t,n,r){void 0===r&&(r=n);var o=Object.getOwnPropertyDescriptor(t,n);o&&!("get"in o?!t.__esModule:o.writable||o.configurable)||(o={enumerable:!0,get:function(){return t[n]}}),Object.defineProperty(e,r,o)}:function(e,t,n,r){void 0===r&&(r=n),e[r]=t[n]}),a=this&&this.__setModuleDefault||(Object.create?function(e,t){Object.defineProperty(e,"default",{enumerable:!0,value:t})}:function(e,t){e.default=t}),c=this&&this.__importStar||function(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var n in e)"default"!==n&&Object.prototype.hasOwnProperty.call(e,n)&&i(t,e,n);return a(t,e),t},s=this&&this.__awaiter||function(e,t,n,r){return new(n||(n=Promise))((function(o,i){function a(e){try{s(r.next(e))}catch(e){i(e)}}function c(e){try{s(r.throw(e))}catch(e){i(e)}}function s(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,c)}s((r=r.apply(e,t||[])).next())}))},u=this&&this.__generator||function(e,t){var n,r,o,i,a={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return i={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function c(c){return function(s){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;i&&(i=0,c[0]&&(a=0)),a;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return a.label++,{value:c[1],done:!1};case 5:a.label++,r=c[1],c=[0];continue;case 7:c=a.ops.pop(),a.trys.pop();continue;default:if(!(o=a.trys,(o=o.length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){a=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){a.label=c[1];break}if(6===c[0]&&a.label<o[1]){a.label=o[1],o=c;break}if(o&&a.label<o[2]){a.label=o[2],a.ops.push(c);break}o[2]&&a.ops.pop(),a.trys.pop();continue}c=t.call(e,a)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,s])}}},l=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.RegeneratorRouter=void 0;var f=l(n(3672)),d=c(n(8489)),p=n(7301),h=n(3060),b=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return o(t,e),t.regenerate=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return d.test("-e","src")?new t:console.log(f.default.red("You are not inside the project Webresources folder!")),[2]}))}))},t.prototype.onAuthenticated=function(){return s(this,void 0,void 0,(function(){return u(this,(function(e){return new h.Regenerator(this.bearer).generate(),[2]}))}))},t}(p.MsalRouter);t.RegeneratorRouter=b},5672:function(e){e.exports=require("@azure/msal-node")},511:function(e){e.exports=require("@xmldom/xmldom")},3672:function(e){e.exports=require("colors")},6858:function(e){e.exports=require("commander")},7252:function(e){e.exports=require("express")},5977:function(e){e.exports=require("express-session")},9937:function(e){e.exports=require("inquirer")},2080:function(e){e.exports=require("open")},8489:function(e){e.exports=require("shelljs")},6566:function(e){e.exports=require("xml2js")},5317:function(e){e.exports=require("child_process")},6982:function(e){e.exports=require("crypto")},9896:function(e){e.exports=require("fs")},5692:function(e){e.exports=require("https")},6928:function(e){e.exports=require("path")},8330:function(e){e.exports=JSON.parse('{"name":"@hso/d365-cli","version":"7.0.9","author":"HSO Innovation <innovation@hso.com> (https://www.hso.com)","description":"Dynamics 365 Command Line Interface for TypeScript projects for Dataverse","repository":{"type":"git","url":"https://github.com/hso-nn/d365-cli.git"},"keywords":["dynamics crm","dynamics d365","webapi","xrm","typescript","d365","dataverse","cli","crm","ce","hso"],"files":["bin/"],"license":"MIT","scripts":{"build":"npm run clean && webpack --mode development","build:prod":"npm run clean && webpack --mode production --bail --progress","clean":"IF exist bin\\\\root\\\\deploy (rmdir /s /q bin\\\\root\\\\deploy)"},"engines":{"node":">=14"},"bin":{"hso-d365":"bin/hso-d365"},"devDependencies":{"@babel/core":"^7.23.3","@babel/preset-env":"^7.23.3","@types/express":"^4.17.21","@types/express-session":"^1.17.10","@types/inquirer":"^9.0.7","@types/node":"^20.10.0","@types/sanitize-html":"^2.9.5","@types/shelljs":"^0.8.15","@types/webpack":"^5.28.5","@types/webpack-node-externals":"^3.0.4","@types/xml2js":"^0.4.14","@types/xrm":"^9.0.77","@typescript-eslint/eslint-plugin":"^6.12.0","@typescript-eslint/parser":"^6.12.0","babel-loader":"^9.1.3","copy-webpack-plugin":"^11.0.0","eslint":"^8.54.0","eslint-webpack-plugin":"^4.0.1","json-loader":"^0.5.7","terser-webpack-plugin":"^5.3.11","ts-loader":"^9.5.1","ts-node":"^10.9.1","typescript":"^5.3.2","webpack":"^5.89.0","webpack-cli":"^5.1.4","webpack-node-externals":"^3.0.0"},"dependencies":{"@azure/msal-node":"^3.2.1","@xmldom/xmldom":"^0.8.10","colors":"^1.4.0","commander":"^11.1.0","express":"^4.18.2","express-session":"^1.17.3","inquirer":"^7.3.3","open":"^7.3.0","shelljs":"^0.8.5","xml2js":"^0.6.2"}}')}},t={};(function n(r){var o=t[r];if(void 0!==o)return o.exports;var i=t[r]={exports:{}};return e[r].call(i.exports,i,i.exports,n),i.exports})(7670)}();